/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1993-01-13' AND O_ORDERDATE < date '1993-01-13' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20

/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 17 AND P_TYPE LIKE '%%ECONOMY PLATED STEEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100

/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ROMANIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO') ORDER BY VALUE DESC

/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-09-21' AND l_shipdate > date '1993-05-16' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20

/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('MAIL', 'MAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-02-27' AND l_receiptdate < date '1996-02-27' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode

/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%quickly%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC

/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1993-03-03', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus

/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%sky%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-04-26' AND L_SHIPDATE < date '1996-04-26' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' ORDER BY S_NAME

/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1997-02-07' AND l_shipdate < date '1997-02-07' + interval '1' year AND l_discount between 0.06-1 AND 0.01+1 AND l_quantity < 35

/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 30) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100

/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1993-02-16' AND l_shipdate < date '1993-02-16' + interval '1' month

/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'PERU') OR (NA.N_NAME = 'PERU' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1994-09-29' AND date '1994-09-29' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR

/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'P' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'SAUDI ARABIA' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100

/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#32' and p_container in ('SM PKG', 'SM PKG', 'SM BOX', 'MED PACK') and l_quantity >= 30 and l_quantity <= 22 + 10 and p_size between 41 and 21 + 15 and l_shipmode in ('REG AIR', 'RAIL') and l_shipinstruct = 'NONE' ) or ( p_partkey = l_partkey and p_brand = 'Brand#25' and p_container in ('SM DRUM', 'WRAP BOX', 'LG PKG', 'MED JAR') and l_quantity >= 43 and l_quantity <= 35 + 10 and p_size between 45 and 11 + 15 and l_shipmode in ('FOB', 'MAIL') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#34' and p_container in ('LG PACK', 'LG DRUM', 'WRAP CAN', 'JUMBO PKG') and l_quantity >= 7 and l_quantity <= 45 + 10 and p_size between 42 and 38 + 15 and l_shipmode in ('TRUCK', 'AIR') and l_shipinstruct = 'DELIVER IN PERSON' )

/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1994-10-30' AND l_shipdate < date '1994-10-30' + interval '3' MONTH GROUP BY l_suppkey

/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1992-03-20' AND date '1992-03-20' + interval '1' year AND P_TYPE= 'ECONOMY BRUSHED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR

/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('21', '34', '10', '27', '34', '28', '24') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('25', '11', '24', '21', '14', '34', '10') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode

/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-06-22' and o_orderdate < adddate('1994-06-22', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority

/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#45' and p_type like '%MEDIUM BURNISHED STEEL%' and p_size in (14, 26, 40, 46, 29, 6, 21, 40) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%pending%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size

/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%pink%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC

/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1997-12-07' AND o_orderdate < date '1997-12-07' + interval '1' year GROUP BY n_name ORDER BY revenue desc

/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#12' AND P_CONTAINER = 'JUMBO BAG' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1996-04-16' AND O_ORDERDATE < date '1996-04-16' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 10 AND P_TYPE LIKE '%%PROMO POLISHED BRASS' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'JORDAN' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED STATES') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-10-28' AND l_shipdate > date '1998-05-14' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('SHIP', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1992-09-20' AND l_receiptdate < date '1992-09-20' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%accounts%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1992-12-06', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%sky%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-04-26' AND L_SHIPDATE < date '1996-04-26' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1994-09-18' AND l_shipdate < date '1994-09-18' + interval '1' year AND l_discount between 0.01-1 AND 0.03+1 AND l_quantity < 16


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 26) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-05-29' AND l_shipdate < date '1992-05-29' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'UNITED STATES') OR (NA.N_NAME = 'UNITED STATES' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1995-10-26' AND date '1995-10-26' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ROMANIA' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('WRAP CASE', 'JUMBO JAR', 'MED JAR', 'JUMBO JAR') and l_quantity >= 40 and l_quantity <= 1 + 10 and p_size between 38 and 39 + 15 and l_shipmode in ('MAIL', 'TRUCK') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#53' and p_container in ('JUMBO CAN', 'MED CAN', 'MED JAR', 'WRAP DRUM') and l_quantity >= 37 and l_quantity <= 29 + 10 and p_size between 17 and 26 + 15 and l_shipmode in ('TRUCK', 'MAIL') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('WRAP PACK', 'LG CAN', 'MED CASE', 'SM PKG') and l_quantity >= 50 and l_quantity <= 14 + 10 and p_size between 37 and 22 + 15 and l_shipmode in ('SHIP', 'MAIL') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1994-10-30' AND l_shipdate < date '1994-10-30' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('16', '18', '29', '22', '32', '17', '25') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('12', '12', '27', '18', '18', '26', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-06-22' and o_orderdate < adddate('1994-06-22', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#54' and p_type like '%SMALL BRUSHED NICKEL%' and p_size in (44, 34, 1, 11, 18, 17, 27, 9) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%furiously%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%navajo%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'AFRICA' AND o_orderdate >= date '1992-07-29' AND o_orderdate < date '1992-07-29' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#14' AND P_CONTAINER = 'SM PACK' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1993-04-24' AND O_ORDERDATE < date '1993-04-24' + interval '3' month AND L_RETURNFLAG = 'A' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 19 AND P_TYPE LIKE '%%STANDARD PLATED BRASS' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'BRAZIL' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'GERMANY') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1992-12-12' AND l_shipdate > date '1995-08-06' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('AIR', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1998-07-31' AND l_receiptdate < date '1998-07-31' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%haggle%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1996-10-15', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%pale%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-02-27' AND L_SHIPDATE < date '1996-02-27' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1995-12-18' AND l_shipdate < date '1995-12-18' + interval '1' year AND l_discount between 0.02-1 AND 0.03+1 AND l_quantity < 43


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 13) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-09-03' AND l_shipdate < date '1992-09-03' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'FRANCE') OR (NA.N_NAME = 'FRANCE' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1994-08-31' AND date '1994-08-31' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'FRANCE' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('JUMBO BOX', 'LG PKG', 'LG CAN', 'JUMBO JAR') and l_quantity >= 36 and l_quantity <= 47 + 10 and p_size between 31 and 11 + 15 and l_shipmode in ('MAIL', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('SM DRUM', 'WRAP BOX', 'SM DRUM', 'WRAP CASE') and l_quantity >= 47 and l_quantity <= 11 + 10 and p_size between 47 and 5 + 15 and l_shipmode in ('REG AIR', 'RAIL') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('WRAP BAG', 'MED PKG', 'WRAP PACK', 'LG CAN') and l_quantity >= 4 and l_quantity <= 20 + 10 and p_size between 20 and 21 + 15 and l_shipmode in ('FOB', 'SHIP') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1994-10-30' AND l_shipdate < date '1994-10-30' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-09-16' AND date '1993-09-16' + interval '1' year AND P_TYPE= 'ECONOMY PLATED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('14', '17', '31', '17', '27', '24', '10') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('33', '26', '32', '28', '31', '19', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-09-21' and o_orderdate < adddate('1994-09-21', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#43' and p_type like '%ECONOMY ANODIZED COPPER%' and p_size in (2, 40, 15, 19, 6, 7, 13, 49) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%pinto%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%chocolate%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND o_orderdate >= date '1996-02-07' AND o_orderdate < date '1996-02-07' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#23' AND P_CONTAINER = 'SM DRUM' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1997-08-28' AND O_ORDERDATE < date '1997-08-28' + interval '3' month AND L_RETURNFLAG = 'A' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 23 AND P_TYPE LIKE '%%ECONOMY POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'KENYA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOZAMBIQUE') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1992-04-27' AND l_shipdate > date '1996-11-01' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('MAIL', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-05-10' AND l_receiptdate < date '1996-05-10' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%haggle%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1992-12-06', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%sky%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-04-26' AND L_SHIPDATE < date '1996-04-26' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1992-04-09' AND l_shipdate < date '1992-04-09' + interval '1' year AND l_discount between 0.0-1 AND 0.06+1 AND l_quantity < 13


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 20) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-09-03' AND l_shipdate < date '1992-09-03' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'MOROCCO') OR (NA.N_NAME = 'MOROCCO' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1995-03-08' AND date '1995-03-08' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ETHIOPIA' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('JUMBO BOX', 'LG PKG', 'LG CAN', 'JUMBO JAR') and l_quantity >= 36 and l_quantity <= 47 + 10 and p_size between 31 and 11 + 15 and l_shipmode in ('MAIL', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('SM DRUM', 'WRAP BOX', 'SM DRUM', 'WRAP CASE') and l_quantity >= 47 and l_quantity <= 11 + 10 and p_size between 47 and 5 + 15 and l_shipmode in ('REG AIR', 'RAIL') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('WRAP BAG', 'MED PKG', 'WRAP PACK', 'LG CAN') and l_quantity >= 4 and l_quantity <= 20 + 10 and p_size between 20 and 21 + 15 and l_shipmode in ('FOB', 'SHIP') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1992-12-15' AND l_shipdate < date '1992-12-15' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1998-02-26' AND date '1998-02-26' + interval '1' year AND P_TYPE= 'ECONOMY BURNISHED TIN') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '13', '34', '32', '34', '31', '32') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('28', '26', '34', '28', '21', '11', '15') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-06-22' and o_orderdate < adddate('1994-06-22', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#51' and p_type like '%LARGE BURNISHED BRASS%' and p_size in (30, 22, 44, 14, 27, 8, 9, 6) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%even%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%moccasin%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= date '1995-12-27' AND o_orderdate < date '1995-12-27' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#11' AND P_CONTAINER = 'MED BOX' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-05-28' AND O_ORDERDATE < date '1992-05-28' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 18 AND P_TYPE LIKE '%%LARGE POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'SAUDI ARABIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1994-01-29' AND l_shipdate > date '1998-08-12' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('RAIL', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-11-06' AND l_receiptdate < date '1996-11-06' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%carefully%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1998-08-17', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%midnight%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1993-06-23' AND L_SHIPDATE < date '1993-06-23' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'KENYA' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1993-09-22' AND l_shipdate < date '1993-09-22' + interval '1' year AND l_discount between 0.03-1 AND 0.06+1 AND l_quantity < 30


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 45) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-02-14' AND l_shipdate < date '1995-02-14' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'PERU') OR (NA.N_NAME = 'PERU' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1994-09-29' AND date '1994-09-29' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'O' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED STATES' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('JUMBO BOX', 'LG PKG', 'LG CAN', 'JUMBO JAR') and l_quantity >= 36 and l_quantity <= 47 + 10 and p_size between 31 and 11 + 15 and l_shipmode in ('MAIL', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('SM DRUM', 'WRAP BOX', 'SM DRUM', 'WRAP CASE') and l_quantity >= 47 and l_quantity <= 11 + 10 and p_size between 47 and 5 + 15 and l_shipmode in ('REG AIR', 'RAIL') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('WRAP BAG', 'MED PKG', 'WRAP PACK', 'LG CAN') and l_quantity >= 4 and l_quantity <= 20 + 10 and p_size between 20 and 21 + 15 and l_shipmode in ('FOB', 'SHIP') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1995-05-05' AND l_shipdate < date '1995-05-05' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-02-14' AND date '1995-02-14' + interval '1' year AND P_TYPE= 'ECONOMY BRUSHED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('17', '22', '26', '26', '15', '22', '11') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('19', '24', '16', '22', '13', '17', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1995-11-19' and o_orderdate < adddate('1995-11-19', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#51' and p_type like '%LARGE BURNISHED BRASS%' and p_size in (30, 22, 44, 14, 27, 8, 9, 6) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%even%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%chocolate%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1994-10-26' AND o_orderdate < date '1994-10-26' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#23' AND P_CONTAINER = 'SM DRUM' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1994-12-17' AND O_ORDERDATE < date '1994-12-17' + interval '3' month AND L_RETURNFLAG = 'A' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 33 AND P_TYPE LIKE '%%ECONOMY BURNISHED BRASS' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOZAMBIQUE' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'FRANCE') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'FURNITURE' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1995-08-28' AND l_shipdate > date '1998-01-04' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('MAIL', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-05-10' AND l_receiptdate < date '1996-05-10' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%are%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1992-12-06', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%cornsilk%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1992-08-30' AND L_SHIPDATE < date '1992-08-30' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED STATES' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1995-12-18' AND l_shipdate < date '1995-12-18' + interval '1' year AND l_discount between 0.02-1 AND 0.03+1 AND l_quantity < 43


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 30) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-09-03' AND l_shipdate < date '1992-09-03' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'SAUDI ARABIA') OR (NA.N_NAME = 'SAUDI ARABIA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1992-03-01' AND date '1992-03-01' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'P' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'FRANCE' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#35' and p_container in ('JUMBO JAR', 'MED CAN', 'LG PKG', 'WRAP CAN') and l_quantity >= 29 and l_quantity <= 9 + 10 and p_size between 23 and 2 + 15 and l_shipmode in ('TRUCK', 'TRUCK') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#34' and p_container in ('LG BOX', 'MED CAN', 'SM PACK', 'SM PKG') and l_quantity >= 17 and l_quantity <= 31 + 10 and p_size between 14 and 28 + 15 and l_shipmode in ('AIR', 'SHIP') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#53' and p_container in ('LG CAN', 'LG CAN', 'SM DRUM', 'JUMBO BOX') and l_quantity >= 8 and l_quantity <= 2 + 10 and p_size between 39 and 12 + 15 and l_shipmode in ('MAIL', 'MAIL') and l_shipinstruct = 'NONE' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1995-10-27' AND l_shipdate < date '1995-10-27' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-12-05' AND date '1993-12-05' + interval '1' year AND P_TYPE= 'ECONOMY BRUSHED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '30', '21', '10', '12', '22', '21') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('20', '15', '20', '16', '32', '30', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-06-22' and o_orderdate < adddate('1994-06-22', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#35' and p_type like '%MEDIUM BRUSHED TIN%' and p_size in (41, 12, 26, 31, 3, 17, 32, 16) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%carefully%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%medium%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'AMERICA' AND o_orderdate >= date '1997-12-11' AND o_orderdate < date '1997-12-11' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#23' AND P_CONTAINER = 'SM DRUM' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1998-06-05' AND O_ORDERDATE < date '1998-06-05' + interval '3' month AND L_RETURNFLAG = 'R' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 14 AND P_TYPE LIKE '%%ECONOMY BURNISHED TIN' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ETHIOPIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ALGERIA') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-09-21' AND l_shipdate > date '1993-05-16' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('SHIP', 'AIR') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1992-07-18' AND l_receiptdate < date '1992-07-18' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%accounts%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1992-12-06', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%purple%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1997-07-21' AND L_SHIPDATE < date '1997-07-21' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'CHINA' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1995-12-18' AND l_shipdate < date '1995-12-18' + interval '1' year AND l_discount between 0.02-1 AND 0.03+1 AND l_quantity < 43


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 26) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1994-04-05' AND l_shipdate < date '1994-04-05' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'MOZAMBIQUE') OR (NA.N_NAME = 'MOZAMBIQUE' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1998-04-02' AND date '1998-04-02' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#33' and p_container in ('MED BAG', 'LG BOX', 'SM PACK', 'LG BOX') and l_quantity >= 2 and l_quantity <= 37 + 10 and p_size between 29 and 32 + 15 and l_shipmode in ('MAIL', 'MAIL') and l_shipinstruct = 'NONE' ) or ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('WRAP BAG', 'WRAP BAG', 'MED JAR', 'LG PKG') and l_quantity >= 17 and l_quantity <= 31 + 10 and p_size between 14 and 23 + 15 and l_shipmode in ('RAIL', 'SHIP') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#32' and p_container in ('LG PACK', 'MED PACK', 'JUMBO BOX', 'WRAP PACK') and l_quantity >= 7 and l_quantity <= 15 + 10 and p_size between 16 and 36 + 15 and l_shipmode in ('RAIL', 'MAIL') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1993-03-13' AND l_shipdate < date '1993-03-13' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1994-01-21' AND date '1994-01-21' + interval '1' year AND P_TYPE= 'MEDIUM BRUSHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '30', '21', '10', '12', '22', '21') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('20', '15', '20', '16', '32', '30', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-01-25' and o_orderdate < adddate('1996-01-25', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#53' and p_type like '%MEDIUM POLISHED NICKEL%' and p_size in (25, 42, 18, 11, 2, 3, 18, 32) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%carefully%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%firebrick%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1995-03-23' AND o_orderdate < date '1995-03-23' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#35' AND P_CONTAINER = 'MED CAN' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-12-15' AND O_ORDERDATE < date '1992-12-15' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 2 AND P_TYPE LIKE '%%LARGE POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'INDONESIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOZAMBIQUE') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-09-21' AND l_shipdate > date '1993-05-16' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('TRUCK', 'MAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1994-04-04' AND l_receiptdate < date '1994-04-04' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%haggle%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1994-08-05', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%purple%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-08-25' AND L_SHIPDATE < date '1996-08-25' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'JORDAN' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1995-12-18' AND l_shipdate < date '1995-12-18' + interval '1' year AND l_discount between 0.02-1 AND 0.03+1 AND l_quantity < 43


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 1) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-09-03' AND l_shipdate < date '1992-09-03' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'PERU') OR (NA.N_NAME = 'PERU' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1994-09-29' AND date '1994-09-29' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'O' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'RUSSIA' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#35' and p_container in ('WRAP PKG', 'WRAP BAG', 'MED CAN', 'MED CAN') and l_quantity >= 47 and l_quantity <= 8 + 10 and p_size between 11 and 2 + 15 and l_shipmode in ('REG AIR', 'REG AIR') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#25' and p_container in ('LG BOX', 'SM BAG', 'WRAP BAG', 'JUMBO BAG') and l_quantity >= 45 and l_quantity <= 1 + 10 and p_size between 45 and 23 + 15 and l_shipmode in ('REG AIR', 'MAIL') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('WRAP DRUM', 'WRAP DRUM', 'MED DRUM', 'JUMBO PACK') and l_quantity >= 17 and l_quantity <= 18 + 10 and p_size between 2 and 47 + 15 and l_shipmode in ('SHIP', 'REG AIR') and l_shipinstruct = 'NONE' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1998-11-02' AND l_shipdate < date '1998-11-02' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1997-05-25' AND date '1997-05-25' + interval '1' year AND P_TYPE= 'SMALL BRUSHED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('21', '30', '24', '15', '28', '33', '23') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('10', '15', '32', '25', '19', '30', '12') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1995-11-26' and o_orderdate < adddate('1995-11-26', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#55' and p_type like '%ECONOMY BRUSHED COPPER%' and p_size in (12, 32, 16, 34, 30, 47, 28, 28) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%deposits%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%chocolate%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1996-01-30' AND o_orderdate < date '1996-01-30' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#35' AND P_CONTAINER = 'SM BOX' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-12-15' AND O_ORDERDATE < date '1992-12-15' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 2 AND P_TYPE LIKE '%%LARGE POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'MACHINERY' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1993-10-29' AND l_shipdate > date '1997-05-14' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('REG AIR', 'AIR') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1993-05-25' AND l_receiptdate < date '1993-05-25' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%haggle%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1992-12-06', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%drab%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1998-04-24' AND L_SHIPDATE < date '1998-04-24' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED KINGDOM' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1993-08-16' AND l_shipdate < date '1993-08-16' + interval '1' year AND l_discount between 0.08-1 AND 0.07+1 AND l_quantity < 48


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 31) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1994-09-27' AND l_shipdate < date '1994-09-27' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'ETHIOPIA') OR (NA.N_NAME = 'ETHIOPIA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1992-09-28' AND date '1992-09-28' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('WRAP BAG', 'JUMBO JAR', 'MED BOX', 'JUMBO PKG') and l_quantity >= 50 and l_quantity <= 39 + 10 and p_size between 17 and 48 + 15 and l_shipmode in ('RAIL', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('SM CASE', 'WRAP DRUM', 'MED BOX', 'MED DRUM') and l_quantity >= 28 and l_quantity <= 36 + 10 and p_size between 45 and 20 + 15 and l_shipmode in ('MAIL', 'SHIP') and l_shipinstruct = 'NONE' ) or ( p_partkey = l_partkey and p_brand = 'Brand#21' and p_container in ('JUMBO BAG', 'MED JAR', 'LG PKG', 'SM PKG') and l_quantity >= 46 and l_quantity <= 18 + 10 and p_size between 2 and 39 + 15 and l_shipmode in ('TRUCK', 'AIR') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1996-12-27' AND l_shipdate < date '1996-12-27' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('34', '32', '11', '25', '23', '15', '10') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('33', '20', '26', '24', '13', '17', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1992-01-19' and o_orderdate < adddate('1992-01-19', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#51' and p_type like '%LARGE BURNISHED BRASS%' and p_size in (30, 22, 44, 14, 27, 8, 9, 6) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%even%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%cornsilk%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1995-03-23' AND o_orderdate < date '1995-03-23' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#24' AND P_CONTAINER = 'WRAP PKG' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-12-15' AND O_ORDERDATE < date '1992-12-15' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 41 AND P_TYPE LIKE '%%STANDARD PLATED BRASS' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ROMANIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'GERMANY') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-09-21' AND l_shipdate > date '1993-05-16' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('REG AIR', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1997-09-10' AND l_receiptdate < date '1997-09-10' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%pinto%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1997-07-29', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%sky%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-04-26' AND L_SHIPDATE < date '1996-04-26' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1992-04-24' AND l_shipdate < date '1992-04-24' + interval '1' year AND l_discount between 0.08-1 AND 0.04+1 AND l_quantity < 40


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 17) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-08-21' AND l_shipdate < date '1995-08-21' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'PERU') OR (NA.N_NAME = 'PERU' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1994-09-29' AND date '1994-09-29' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED STATES' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('JUMBO BOX', 'LG PKG', 'LG CAN', 'JUMBO JAR') and l_quantity >= 36 and l_quantity <= 47 + 10 and p_size between 31 and 11 + 15 and l_shipmode in ('MAIL', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('SM DRUM', 'WRAP BOX', 'SM DRUM', 'WRAP CASE') and l_quantity >= 47 and l_quantity <= 11 + 10 and p_size between 47 and 5 + 15 and l_shipmode in ('REG AIR', 'RAIL') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('WRAP BAG', 'MED PKG', 'WRAP PACK', 'LG CAN') and l_quantity >= 4 and l_quantity <= 20 + 10 and p_size between 20 and 21 + 15 and l_shipmode in ('FOB', 'SHIP') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1998-02-17' AND l_shipdate < date '1998-02-17' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-10-30' AND date '1993-10-30' + interval '1' year AND P_TYPE= 'ECONOMY BURNISHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('25', '34', '16', '20', '28', '28', '22') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('14', '16', '28', '30', '11', '23', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-06-09' and o_orderdate < adddate('1994-06-09', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#31' and p_type like '%ECONOMY POLISHED NICKEL%' and p_size in (39, 8, 37, 28, 22, 37, 17, 19) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%final%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%orchid%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'AFRICA' AND o_orderdate >= date '1996-01-31' AND o_orderdate < date '1996-01-31' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#34' AND P_CONTAINER = 'JUMBO BOX' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-12-15' AND O_ORDERDATE < date '1992-12-15' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 50 AND P_TYPE LIKE '%%MEDIUM BURNISHED STEEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED KINGDOM' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED STATES') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1994-11-11' AND l_shipdate > date '1995-05-28' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('TRUCK', 'AIR') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1993-05-17' AND l_receiptdate < date '1993-05-17' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%furiously%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1996-01-14', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%bisque%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1992-02-21' AND L_SHIPDATE < date '1992-02-21' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'VIETNAM' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1994-06-22' AND l_shipdate < date '1994-06-22' + interval '1' year AND l_discount between 0.03-1 AND 0.07+1 AND l_quantity < 44


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 20) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-08-04' AND l_shipdate < date '1992-08-04' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'CANADA') OR (NA.N_NAME = 'CANADA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1996-04-11' AND date '1996-04-11' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#34' and p_container in ('JUMBO BAG', 'MED DRUM', 'JUMBO BOX', 'WRAP CAN') and l_quantity >= 35 and l_quantity <= 39 + 10 and p_size between 48 and 26 + 15 and l_shipmode in ('MAIL', 'MAIL') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#55' and p_container in ('MED BOX', 'WRAP PACK', 'JUMBO JAR', 'MED CAN') and l_quantity >= 39 and l_quantity <= 46 + 10 and p_size between 18 and 14 + 15 and l_shipmode in ('TRUCK', 'TRUCK') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#45' and p_container in ('WRAP PACK', 'MED DRUM', 'JUMBO BAG', 'MED DRUM') and l_quantity >= 31 and l_quantity <= 39 + 10 and p_size between 19 and 47 + 15 and l_shipmode in ('MAIL', 'SHIP') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1994-10-30' AND l_shipdate < date '1994-10-30' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1996-09-27' AND date '1996-09-27' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('34', '13', '20', '23', '26', '26', '20') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('34', '22', '21', '27', '18', '25', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-06-22' and o_orderdate < adddate('1994-06-22', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#12' and p_type like '%LARGE ANODIZED COPPER%' and p_size in (45, 13, 7, 48, 13, 43, 16, 31) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%unusual%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%chocolate%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'AMERICA' AND o_orderdate >= date '1998-02-12' AND o_orderdate < date '1998-02-12' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#23' AND P_CONTAINER = 'WRAP CAN' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-12-15' AND O_ORDERDATE < date '1992-12-15' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 2 AND P_TYPE LIKE '%%SMALL ANODIZED COPPER' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'GERMANY' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'CANADA') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'MACHINERY' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-03-15' AND l_shipdate > date '1994-01-17' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('SHIP', 'FOB') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1993-02-27' AND l_receiptdate < date '1993-02-27' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%fluffily%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1998-02-28', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%black%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1997-01-08' AND L_SHIPDATE < date '1997-01-08' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ETHIOPIA' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1996-10-20' AND l_shipdate < date '1996-10-20' + interval '1' year AND l_discount between 0.03-1 AND 0.02+1 AND l_quantity < 24


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 30) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1994-02-24' AND l_shipdate < date '1994-02-24' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'RUSSIA') OR (NA.N_NAME = 'RUSSIA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1996-09-13' AND date '1996-09-13' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'O' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'JORDAN' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('LG BOX', 'SM PACK', 'JUMBO CAN', 'MED BAG') and l_quantity >= 38 and l_quantity <= 28 + 10 and p_size between 43 and 6 + 15 and l_shipmode in ('REG AIR', 'TRUCK') and l_shipinstruct = 'NONE' ) or ( p_partkey = l_partkey and p_brand = 'Brand#44' and p_container in ('MED CASE', 'MED JAR', 'SM PACK', 'MED JAR') and l_quantity >= 19 and l_quantity <= 26 + 10 and p_size between 23 and 18 + 15 and l_shipmode in ('AIR', 'MAIL') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('SM BAG', 'MED CASE', 'SM CASE', 'SM PKG') and l_quantity >= 15 and l_quantity <= 28 + 10 and p_size between 37 and 50 + 15 and l_shipmode in ('AIR', 'MAIL') and l_shipinstruct = 'COLLECT COD' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1997-02-07' AND l_shipdate < date '1997-02-07' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1994-09-26' AND date '1994-09-26' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('16', '34', '14', '10', '20', '30', '13') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('17', '30', '22', '25', '29', '33', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1995-02-07' and o_orderdate < adddate('1995-02-07', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#13' and p_type like '%ECONOMY BURNISHED BRASS%' and p_size in (7, 2, 15, 38, 16, 36, 39, 5) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%wake%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%black%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1996-06-26' AND o_orderdate < date '1996-06-26' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#35' AND P_CONTAINER = 'JUMBO BAG' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1993-03-20' AND O_ORDERDATE < date '1993-03-20' + interval '3' month AND L_RETURNFLAG = 'R' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 2 AND P_TYPE LIKE '%%LARGE POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ROMANIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'FURNITURE' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1993-09-29' AND l_shipdate > date '1994-09-16' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('REG AIR', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1993-10-09' AND l_receiptdate < date '1993-10-09' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%express%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1998-01-08', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%cyan%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1992-12-27' AND L_SHIPDATE < date '1992-12-27' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'EGYPT' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1994-11-13' AND l_shipdate < date '1994-11-13' + interval '1' year AND l_discount between 0.02-1 AND 0.05+1 AND l_quantity < 7


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 26) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-09-03' AND l_shipdate < date '1992-09-03' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'ALGERIA') OR (NA.N_NAME = 'ALGERIA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1992-10-17' AND date '1992-10-17' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#45' and p_container in ('WRAP PACK', 'LG CAN', 'SM PKG', 'WRAP BAG') and l_quantity >= 4 and l_quantity <= 9 + 10 and p_size between 17 and 34 + 15 and l_shipmode in ('RAIL', 'AIR') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('MED DRUM', 'SM PACK', 'WRAP PKG', 'WRAP BAG') and l_quantity >= 23 and l_quantity <= 23 + 10 and p_size between 16 and 19 + 15 and l_shipmode in ('FOB', 'MAIL') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('WRAP CASE', 'MED BAG', 'JUMBO PKG', 'MED DRUM') and l_quantity >= 24 and l_quantity <= 17 + 10 and p_size between 23 and 45 + 15 and l_shipmode in ('MAIL', 'MAIL') and l_shipinstruct = 'DELIVER IN PERSON' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1994-02-04' AND l_shipdate < date '1994-02-04' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('13', '24', '21', '16', '31', '26', '31') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('21', '26', '17', '20', '24', '13', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-02-10' and o_orderdate < adddate('1996-02-10', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#45' and p_type like '%LARGE PLATED STEEL%' and p_size in (10, 14, 10, 1, 48, 4, 26, 25) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%haggle%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%blue%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'AMERICA' AND o_orderdate >= date '1994-07-15' AND o_orderdate < date '1994-07-15' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#23' AND P_CONTAINER = 'SM DRUM' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-08-15' AND O_ORDERDATE < date '1992-08-15' + interval '3' month AND L_RETURNFLAG = 'R' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 1 AND P_TYPE LIKE '%%ECONOMY PLATED STEEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED KINGDOM') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'FURNITURE' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1992-03-20' AND l_shipdate > date '1993-12-14' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('MAIL', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-05-10' AND l_receiptdate < date '1996-05-10' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%ironic%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1997-11-20', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%red%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-06-07' AND L_SHIPDATE < date '1996-06-07' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1997-11-30' AND l_shipdate < date '1997-11-30' + interval '1' year AND l_discount between 0.03-1 AND 0.09+1 AND l_quantity < 38


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 5) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-09-03' AND l_shipdate < date '1992-09-03' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'PERU') OR (NA.N_NAME = 'PERU' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1994-09-29' AND date '1994-09-29' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('MED CAN', 'WRAP CASE', 'LG BOX', 'MED DRUM') and l_quantity >= 35 and l_quantity <= 17 + 10 and p_size between 20 and 17 + 15 and l_shipmode in ('TRUCK', 'RAIL') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#25' and p_container in ('LG PACK', 'WRAP PKG', 'WRAP PACK', 'WRAP PACK') and l_quantity >= 13 and l_quantity <= 38 + 10 and p_size between 13 and 25 + 15 and l_shipmode in ('RAIL', 'SHIP') and l_shipinstruct = 'NONE' ) or ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('WRAP PACK', 'MED DRUM', 'JUMBO JAR', 'LG DRUM') and l_quantity >= 3 and l_quantity <= 6 + 10 and p_size between 25 and 13 + 15 and l_shipmode in ('RAIL', 'REG AIR') and l_shipinstruct = 'DELIVER IN PERSON' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1996-03-25' AND l_shipdate < date '1996-03-25' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-10-28' AND date '1995-10-28' + interval '1' year AND P_TYPE= 'MEDIUM BRUSHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '20', '16', '18', '27', '17', '29') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('26', '23', '29', '15', '14', '15', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1997-08-10' and o_orderdate < adddate('1997-08-10', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#52' and p_type like '%LARGE POLISHED COPPER%' and p_size in (20, 28, 41, 42, 6, 33, 3, 50) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%final%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%white%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1995-03-23' AND o_orderdate < date '1995-03-23' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#34' AND P_CONTAINER = 'MED CAN' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1997-03-10' AND O_ORDERDATE < date '1997-03-10' + interval '3' month AND L_RETURNFLAG = 'R' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 2 AND P_TYPE LIKE '%%LARGE POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'VIETNAM' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'INDIA') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'AUTOMOBILE' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1993-11-30' AND l_shipdate > date '1994-02-09' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('RAIL', 'MAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1998-09-26' AND l_receiptdate < date '1998-09-26' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%blithely%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1994-02-02', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%blue%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1997-06-30' AND L_SHIPDATE < date '1997-06-30' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'RUSSIA' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1992-06-09' AND l_shipdate < date '1992-06-09' + interval '1' year AND l_discount between 0.03-1 AND 0.01+1 AND l_quantity < 48


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 1) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-09-03' AND l_shipdate < date '1992-09-03' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'SAUDI ARABIA') OR (NA.N_NAME = 'SAUDI ARABIA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1992-08-20' AND date '1992-08-20' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'KENYA' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('JUMBO BOX', 'LG PKG', 'LG CAN', 'JUMBO JAR') and l_quantity >= 36 and l_quantity <= 47 + 10 and p_size between 31 and 11 + 15 and l_shipmode in ('MAIL', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('SM DRUM', 'WRAP BOX', 'SM DRUM', 'WRAP CASE') and l_quantity >= 47 and l_quantity <= 11 + 10 and p_size between 47 and 5 + 15 and l_shipmode in ('REG AIR', 'RAIL') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('WRAP BAG', 'MED PKG', 'WRAP PACK', 'LG CAN') and l_quantity >= 4 and l_quantity <= 20 + 10 and p_size between 20 and 21 + 15 and l_shipmode in ('FOB', 'SHIP') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1994-10-30' AND l_shipdate < date '1994-10-30' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1992-10-10' AND date '1992-10-10' + interval '1' year AND P_TYPE= 'MEDIUM BRUSHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('10', '15', '27', '27', '16', '33', '13') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('15', '19', '33', '31', '34', '14', '12') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-06-22' and o_orderdate < adddate('1994-06-22', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#45' and p_type like '%MEDIUM POLISHED NICKEL%' and p_size in (15, 12, 3, 35, 6, 42, 15, 42) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%ironic%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%sienna%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'AMERICA' AND o_orderdate >= date '1997-06-17' AND o_orderdate < date '1997-06-17' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#23' AND P_CONTAINER = 'SM DRUM' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-08-25' AND O_ORDERDATE < date '1992-08-25' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 4 AND P_TYPE LIKE '%%SMALL BRUSHED BRASS' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ROMANIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'FURNITURE' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1995-05-20' AND l_shipdate > date '1996-12-08' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('MAIL', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-05-10' AND l_receiptdate < date '1996-05-10' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%final%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1993-06-19', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%sky%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-04-26' AND L_SHIPDATE < date '1996-04-26' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1995-12-18' AND l_shipdate < date '1995-12-18' + interval '1' year AND l_discount between 0.02-1 AND 0.03+1 AND l_quantity < 43


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 2) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-11-19' AND l_shipdate < date '1995-11-19' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'ARGENTINA') OR (NA.N_NAME = 'ARGENTINA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1998-06-24' AND date '1998-06-24' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'O' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'FRANCE' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#32' and p_container in ('JUMBO BAG', 'LG DRUM', 'LG PACK', 'MED PACK') and l_quantity >= 29 and l_quantity <= 28 + 10 and p_size between 42 and 48 + 15 and l_shipmode in ('SHIP', 'AIR') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#15' and p_container in ('WRAP BAG', 'MED DRUM', 'WRAP PACK', 'SM BAG') and l_quantity >= 43 and l_quantity <= 30 + 10 and p_size between 29 and 48 + 15 and l_shipmode in ('AIR', 'AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('LG DRUM', 'LG PKG', 'SM CASE', 'SM CASE') and l_quantity >= 20 and l_quantity <= 32 + 10 and p_size between 8 and 30 + 15 and l_shipmode in ('SHIP', 'MAIL') and l_shipinstruct = 'COLLECT COD' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1993-07-25' AND l_shipdate < date '1993-07-25' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '30', '21', '10', '12', '22', '21') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('20', '15', '20', '16', '32', '30', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1995-11-03' and o_orderdate < adddate('1995-11-03', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#53' and p_type like '%SMALL ANODIZED COPPER%' and p_size in (6, 45, 5, 20, 48, 35, 42, 45) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%are%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%tomato%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1995-03-23' AND o_orderdate < date '1995-03-23' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#32' AND P_CONTAINER = 'SM BOX' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-12-15' AND O_ORDERDATE < date '1992-12-15' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 23 AND P_TYPE LIKE '%%SMALL POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ROMANIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'MACHINERY' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-09-14' AND l_shipdate > date '1995-09-03' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('AIR', 'AIR') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-12-02' AND l_receiptdate < date '1996-12-02' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%wake%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1993-11-18', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%moccasin%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1993-01-22' AND L_SHIPDATE < date '1993-01-22' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED STATES' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1995-12-18' AND l_shipdate < date '1995-12-18' + interval '1' year AND l_discount between 0.02-1 AND 0.03+1 AND l_quantity < 43


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 34) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1993-11-07' AND l_shipdate < date '1993-11-07' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'CANADA') OR (NA.N_NAME = 'CANADA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1994-12-03' AND date '1994-12-03' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'O' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#33' and p_container in ('WRAP DRUM', 'WRAP PKG', 'MED BOX', 'LG BOX') and l_quantity >= 45 and l_quantity <= 38 + 10 and p_size between 15 and 9 + 15 and l_shipmode in ('SHIP', 'TRUCK') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('MED JAR', 'MED PACK', 'MED BOX', 'JUMBO PKG') and l_quantity >= 26 and l_quantity <= 14 + 10 and p_size between 44 and 22 + 15 and l_shipmode in ('RAIL', 'REG AIR') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#25' and p_container in ('WRAP DRUM', 'LG BOX', 'MED BAG', 'JUMBO BOX') and l_quantity >= 8 and l_quantity <= 1 + 10 and p_size between 5 and 1 + 15 and l_shipmode in ('RAIL', 'REG AIR') and l_shipinstruct = 'COLLECT COD' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1994-10-30' AND l_shipdate < date '1994-10-30' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '30', '21', '10', '12', '22', '21') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('20', '15', '20', '16', '32', '30', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1992-11-15' and o_orderdate < adddate('1992-11-15', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#45' and p_type like '%STANDARD PLATED TIN%' and p_size in (12, 16, 9, 10, 14, 26, 28, 35) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%even%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%cornsilk%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= date '1993-03-03' AND o_orderdate < date '1993-03-03' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#22' AND P_CONTAINER = 'SM PACK' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-12-15' AND O_ORDERDATE < date '1992-12-15' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 34 AND P_TYPE LIKE '%%ECONOMY ANODIZED COPPER' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'RUSSIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOZAMBIQUE') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'MACHINERY' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1997-12-26' AND l_shipdate > date '1992-12-05' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('MAIL', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-05-10' AND l_receiptdate < date '1996-05-10' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%packages%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1992-12-06', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%cyan%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1992-09-16' AND L_SHIPDATE < date '1992-09-16' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'VIETNAM' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1996-01-05' AND l_shipdate < date '1996-01-05' + interval '1' year AND l_discount between 0.08-1 AND 0.01+1 AND l_quantity < 4


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 26) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-11-21' AND l_shipdate < date '1992-11-21' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'PERU') OR (NA.N_NAME = 'PERU' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1994-09-29' AND date '1994-09-29' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'O' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'JORDAN' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('JUMBO BOX', 'WRAP PACK', 'SM BOX', 'WRAP DRUM') and l_quantity >= 27 and l_quantity <= 48 + 10 and p_size between 27 and 21 + 15 and l_shipmode in ('SHIP', 'TRUCK') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('SM DRUM', 'WRAP CASE', 'LG DRUM', 'MED JAR') and l_quantity >= 10 and l_quantity <= 27 + 10 and p_size between 15 and 26 + 15 and l_shipmode in ('MAIL', 'SHIP') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('MED DRUM', 'JUMBO PKG', 'LG DRUM', 'JUMBO JAR') and l_quantity >= 12 and l_quantity <= 1 + 10 and p_size between 43 and 14 + 15 and l_shipmode in ('RAIL', 'TRUCK') and l_shipinstruct = 'NONE' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1995-04-02' AND l_shipdate < date '1995-04-02' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1998-03-05' AND date '1998-03-05' + interval '1' year AND P_TYPE= 'SMALL ANODIZED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('22', '16', '24', '17', '34', '20', '14') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('31', '31', '15', '16', '10', '27', '17') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-05-03' and o_orderdate < adddate('1996-05-03', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#33' and p_type like '%SMALL BRUSHED NICKEL%' and p_size in (35, 12, 45, 5, 24, 17, 24, 5) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%pending%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%chocolate%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1995-03-23' AND o_orderdate < date '1995-03-23' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#41' AND P_CONTAINER = 'WRAP CASE' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1995-09-28' AND O_ORDERDATE < date '1995-09-28' + interval '3' month AND L_RETURNFLAG = 'R' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 2 AND P_TYPE LIKE '%%LARGE POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'BRAZIL') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-09-21' AND l_shipdate > date '1993-05-16' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('AIR', 'FOB') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1998-12-09' AND l_receiptdate < date '1998-12-09' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%haggle%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1992-09-29', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%pink%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1994-02-24' AND L_SHIPDATE < date '1994-02-24' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'JORDAN' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1994-11-28' AND l_shipdate < date '1994-11-28' + interval '1' year AND l_discount between 0.01-1 AND 0.09+1 AND l_quantity < 48


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 26) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1994-10-08' AND l_shipdate < date '1994-10-08' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'MOZAMBIQUE') OR (NA.N_NAME = 'MOZAMBIQUE' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1995-02-16' AND date '1995-02-16' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('JUMBO BOX', 'LG PKG', 'LG CAN', 'JUMBO JAR') and l_quantity >= 36 and l_quantity <= 47 + 10 and p_size between 31 and 11 + 15 and l_shipmode in ('MAIL', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('SM DRUM', 'WRAP BOX', 'SM DRUM', 'WRAP CASE') and l_quantity >= 47 and l_quantity <= 11 + 10 and p_size between 47 and 5 + 15 and l_shipmode in ('REG AIR', 'RAIL') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('WRAP BAG', 'MED PKG', 'WRAP PACK', 'LG CAN') and l_quantity >= 4 and l_quantity <= 20 + 10 and p_size between 20 and 21 + 15 and l_shipmode in ('FOB', 'SHIP') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1995-12-17' AND l_shipdate < date '1995-12-17' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('20', '26', '11', '27', '23', '33', '14') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('29', '25', '29', '21', '13', '34', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-06-05' and o_orderdate < adddate('1993-06-05', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#51' and p_type like '%LARGE BURNISHED BRASS%' and p_size in (30, 22, 44, 14, 27, 8, 9, 6) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%even%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%honeydew%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND o_orderdate >= date '1997-09-23' AND o_orderdate < date '1997-09-23' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#23' AND P_CONTAINER = 'SM DRUM' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1994-05-24' AND O_ORDERDATE < date '1994-05-24' + interval '3' month AND L_RETURNFLAG = 'R' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 43 AND P_TYPE LIKE '%%ECONOMY POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ROMANIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-09-21' AND l_shipdate > date '1993-05-16' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('FOB', 'FOB') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1992-03-24' AND l_receiptdate < date '1992-03-24' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%slyly%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1995-02-18', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%ghost%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-04-12' AND L_SHIPDATE < date '1996-04-12' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ALGERIA' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1992-09-28' AND l_shipdate < date '1992-09-28' + interval '1' year AND l_discount between 0.0-1 AND 0.05+1 AND l_quantity < 22


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 33) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1998-05-23' AND l_shipdate < date '1998-05-23' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'PERU') OR (NA.N_NAME = 'PERU' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1994-09-29' AND date '1994-09-29' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('MED BAG', 'SM PKG', 'MED BAG', 'WRAP PACK') and l_quantity >= 38 and l_quantity <= 7 + 10 and p_size between 9 and 13 + 15 and l_shipmode in ('FOB', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#21' and p_container in ('SM DRUM', 'JUMBO PACK', 'SM BAG', 'JUMBO JAR') and l_quantity >= 20 and l_quantity <= 5 + 10 and p_size between 17 and 49 + 15 and l_shipmode in ('RAIL', 'SHIP') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#15' and p_container in ('MED JAR', 'MED JAR', 'SM PKG', 'SM CASE') and l_quantity >= 42 and l_quantity <= 17 + 10 and p_size between 37 and 15 + 15 and l_shipmode in ('TRUCK', 'AIR') and l_shipinstruct = 'DELIVER IN PERSON' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1995-12-26' AND l_shipdate < date '1995-12-26' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1997-04-11' AND date '1997-04-11' + interval '1' year AND P_TYPE= 'PROMO PLATED TIN') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('30', '25', '16', '15', '14', '16', '11') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('28', '28', '22', '33', '30', '19', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-07-22' and o_orderdate < adddate('1993-07-22', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#51' and p_type like '%LARGE BURNISHED BRASS%' and p_size in (30, 22, 44, 14, 27, 8, 9, 6) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%even%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%navajo%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND o_orderdate >= date '1998-04-15' AND o_orderdate < date '1998-04-15' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#51' AND P_CONTAINER = 'SM PACK' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1995-04-14' AND O_ORDERDATE < date '1995-04-14' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 16 AND P_TYPE LIKE '%%ECONOMY POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'SAUDI ARABIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'JAPAN') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1997-12-12' AND l_shipdate > date '1994-05-31' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('MAIL', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-05-10' AND l_receiptdate < date '1996-05-10' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%haggle%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1998-02-14', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%orchid%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1993-02-15' AND L_SHIPDATE < date '1993-02-15' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'GERMANY' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1993-04-21' AND l_shipdate < date '1993-04-21' + interval '1' year AND l_discount between 0.05-1 AND 0.07+1 AND l_quantity < 26


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 29) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1998-01-01' AND l_shipdate < date '1998-01-01' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'CANADA') OR (NA.N_NAME = 'CANADA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1993-04-04' AND date '1993-04-04' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'O' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED STATES' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('WRAP PACK', 'MED BOX', 'JUMBO PACK', 'LG DRUM') and l_quantity >= 24 and l_quantity <= 37 + 10 and p_size between 31 and 34 + 15 and l_shipmode in ('TRUCK', 'TRUCK') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('MED CASE', 'LG DRUM', 'MED CASE', 'SM DRUM') and l_quantity >= 33 and l_quantity <= 11 + 10 and p_size between 25 and 44 + 15 and l_shipmode in ('FOB', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#51' and p_container in ('WRAP PACK', 'JUMBO CAN', 'WRAP BAG', 'LG PKG') and l_quantity >= 7 and l_quantity <= 26 + 10 and p_size between 50 and 23 + 15 and l_shipmode in ('TRUCK', 'FOB') and l_shipinstruct = 'DELIVER IN PERSON' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1994-10-30' AND l_shipdate < date '1994-10-30' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-03-08' AND date '1993-03-08' + interval '1' year AND P_TYPE= 'LARGE POLISHED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('18', '12', '19', '25', '10', '34', '16') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('20', '26', '26', '10', '21', '29', '12') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-08-16' and o_orderdate < adddate('1994-08-16', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#24' and p_type like '%MEDIUM ANODIZED TIN%' and p_size in (2, 23, 15, 9, 49, 32, 31, 22) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%ironic%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%navajo%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= date '1994-02-26' AND o_orderdate < date '1994-02-26' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#23' AND P_CONTAINER = 'SM DRUM' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1994-10-22' AND O_ORDERDATE < date '1994-10-22' + interval '3' month AND L_RETURNFLAG = 'A' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 32 AND P_TYPE LIKE '%%SMALL BRUSHED BRASS' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ROMANIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1992-06-09' AND l_shipdate > date '1995-10-11' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('AIR', 'REG AIR') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1993-01-21' AND l_receiptdate < date '1993-01-21' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%slyly%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1998-07-01', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%sky%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-04-26' AND L_SHIPDATE < date '1996-04-26' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1995-12-18' AND l_shipdate < date '1995-12-18' + interval '1' year AND l_discount between 0.02-1 AND 0.03+1 AND l_quantity < 43


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 26) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-09-03' AND l_shipdate < date '1992-09-03' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'INDONESIA') OR (NA.N_NAME = 'INDONESIA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1997-03-20' AND date '1997-03-20' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('LG DRUM', 'MED CASE', 'JUMBO BAG', 'SM PKG') and l_quantity >= 46 and l_quantity <= 14 + 10 and p_size between 29 and 32 + 15 and l_shipmode in ('AIR', 'TRUCK') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#15' and p_container in ('LG PACK', 'SM BAG', 'LG PKG', 'WRAP PACK') and l_quantity >= 18 and l_quantity <= 37 + 10 and p_size between 43 and 8 + 15 and l_shipmode in ('RAIL', 'FOB') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#23' and p_container in ('JUMBO PKG', 'WRAP CAN', 'MED BAG', 'MED BAG') and l_quantity >= 8 and l_quantity <= 47 + 10 and p_size between 49 and 29 + 15 and l_shipmode in ('MAIL', 'FOB') and l_shipinstruct = 'NONE' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1997-12-29' AND l_shipdate < date '1997-12-29' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1992-08-20' AND date '1992-08-20' + interval '1' year AND P_TYPE= 'MEDIUM BRUSHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('15', '12', '25', '11', '31', '23', '23') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('30', '13', '31', '32', '11', '13', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-05-21' and o_orderdate < adddate('1996-05-21', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#51' and p_type like '%LARGE BURNISHED BRASS%' and p_size in (30, 22, 44, 14, 27, 8, 9, 6) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%even%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%bisque%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1995-03-23' AND o_orderdate < date '1995-03-23' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#51' AND P_CONTAINER = 'MED DRUM' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1997-10-21' AND O_ORDERDATE < date '1997-10-21' + interval '3' month AND L_RETURNFLAG = 'R' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 37 AND P_TYPE LIKE '%%ECONOMY PLATED STEEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'CANADA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'BRAZIL') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-09-21' AND l_shipdate > date '1993-05-16' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('FOB', 'FOB') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1994-05-15' AND l_receiptdate < date '1994-05-15' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%haggle%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1993-03-12', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%orchid%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1995-02-16' AND L_SHIPDATE < date '1995-02-16' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'RUSSIA' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1995-07-24' AND l_shipdate < date '1995-07-24' + interval '1' year AND l_discount between 0.04-1 AND 0.01+1 AND l_quantity < 29


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 29) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-12-12' AND l_shipdate < date '1995-12-12' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'PERU') OR (NA.N_NAME = 'PERU' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1992-09-21' AND date '1992-09-21' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('JUMBO BOX', 'LG PKG', 'LG CAN', 'JUMBO JAR') and l_quantity >= 36 and l_quantity <= 47 + 10 and p_size between 31 and 11 + 15 and l_shipmode in ('MAIL', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('SM DRUM', 'WRAP BOX', 'SM DRUM', 'WRAP CASE') and l_quantity >= 47 and l_quantity <= 11 + 10 and p_size between 47 and 5 + 15 and l_shipmode in ('REG AIR', 'RAIL') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('WRAP BAG', 'MED PKG', 'WRAP PACK', 'LG CAN') and l_quantity >= 4 and l_quantity <= 20 + 10 and p_size between 20 and 21 + 15 and l_shipmode in ('FOB', 'SHIP') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1993-08-23' AND l_shipdate < date '1993-08-23' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1994-02-18' AND date '1994-02-18' + interval '1' year AND P_TYPE= 'LARGE BURNISHED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('15', '26', '21', '31', '15', '20', '33') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('16', '22', '19', '29', '25', '31', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1998-01-02' and o_orderdate < adddate('1998-01-02', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#51' and p_type like '%LARGE BURNISHED BRASS%' and p_size in (30, 22, 44, 14, 27, 8, 9, 6) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%even%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%sky%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'AMERICA' AND o_orderdate >= date '1993-09-30' AND o_orderdate < date '1993-09-30' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#15' AND P_CONTAINER = 'MED JAR' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1993-07-08' AND O_ORDERDATE < date '1993-07-08' + interval '3' month AND L_RETURNFLAG = 'R' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 2 AND P_TYPE LIKE '%%LARGE POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'GERMANY') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'MACHINERY' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1997-08-02' AND l_shipdate > date '1993-04-22' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('RAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1993-03-08' AND l_receiptdate < date '1993-03-08' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%requests%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1995-06-27', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%bisque%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1997-07-20' AND L_SHIPDATE < date '1997-07-20' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED KINGDOM' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1992-12-26' AND l_shipdate < date '1992-12-26' + interval '1' year AND l_discount between 0.07-1 AND 0.02+1 AND l_quantity < 13


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 4) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-07-10' AND l_shipdate < date '1992-07-10' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'UNITED KINGDOM') OR (NA.N_NAME = 'UNITED KINGDOM' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1993-07-22' AND date '1993-07-22' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'JORDAN' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('SM PKG', 'JUMBO JAR', 'MED JAR', 'WRAP CAN') and l_quantity >= 38 and l_quantity <= 40 + 10 and p_size between 5 and 7 + 15 and l_shipmode in ('TRUCK', 'AIR') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('LG PACK', 'MED PACK', 'MED BOX', 'JUMBO PKG') and l_quantity >= 50 and l_quantity <= 35 + 10 and p_size between 3 and 45 + 15 and l_shipmode in ('RAIL', 'MAIL') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('WRAP CAN', 'MED PKG', 'SM BOX', 'WRAP BOX') and l_quantity >= 32 and l_quantity <= 40 + 10 and p_size between 25 and 21 + 15 and l_shipmode in ('FOB', 'REG AIR') and l_shipinstruct = 'NONE' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1994-11-29' AND l_shipdate < date '1994-11-29' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('27', '28', '31', '17', '11', '22', '16') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('19', '15', '20', '26', '34', '22', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1998-07-25' and o_orderdate < adddate('1998-07-25', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#25' and p_type like '%LARGE POLISHED COPPER%' and p_size in (41, 34, 49, 18, 48, 48, 24, 46) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%regular%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%chocolate%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1997-04-29' AND o_orderdate < date '1997-04-29' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#23' AND P_CONTAINER = 'SM DRUM' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1997-06-22' AND O_ORDERDATE < date '1997-06-22' + interval '3' month AND L_RETURNFLAG = 'A' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 41 AND P_TYPE LIKE '%%ECONOMY BURNISHED BRASS' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ROMANIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1994-03-09' AND l_shipdate > date '1994-02-06' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('REG AIR', 'FOB') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1998-03-01' AND l_receiptdate < date '1998-03-01' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%accounts%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1992-12-06', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%tomato%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1997-11-23' AND L_SHIPDATE < date '1997-11-23' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'EGYPT' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1995-12-18' AND l_shipdate < date '1995-12-18' + interval '1' year AND l_discount between 0.02-1 AND 0.03+1 AND l_quantity < 43


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 16) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-04-01' AND l_shipdate < date '1995-04-01' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'PERU') OR (NA.N_NAME = 'PERU' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1994-09-29' AND date '1994-09-29' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'O' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#15' and p_container in ('SM BOX', 'WRAP CASE', 'LG CAN', 'SM BAG') and l_quantity >= 21 and l_quantity <= 25 + 10 and p_size between 32 and 3 + 15 and l_shipmode in ('FOB', 'REG AIR') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#35' and p_container in ('WRAP PKG', 'WRAP BAG', 'MED CASE', 'SM PACK') and l_quantity >= 1 and l_quantity <= 33 + 10 and p_size between 46 and 4 + 15 and l_shipmode in ('TRUCK', 'SHIP') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#32' and p_container in ('WRAP CAN', 'LG DRUM', 'JUMBO PACK', 'SM CASE') and l_quantity >= 19 and l_quantity <= 3 + 10 and p_size between 24 and 28 + 15 and l_shipmode in ('FOB', 'MAIL') and l_shipinstruct = 'NONE' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1994-10-30' AND l_shipdate < date '1994-10-30' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1998-01-03' AND date '1998-01-03' + interval '1' year AND P_TYPE= 'STANDARD PLATED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '30', '21', '10', '12', '22', '21') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('20', '15', '20', '16', '32', '30', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1992-08-29' and o_orderdate < adddate('1992-08-29', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#52' and p_type like '%ECONOMY ANODIZED STEEL%' and p_size in (43, 32, 5, 3, 1, 20, 32, 11) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%to%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%chocolate%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= date '1995-03-07' AND o_orderdate < date '1995-03-07' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#23' AND P_CONTAINER = 'LG PACK' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1993-01-22' AND O_ORDERDATE < date '1993-01-22' + interval '3' month AND L_RETURNFLAG = 'A' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 2 AND P_TYPE LIKE '%%LARGE POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ROMANIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'AUTOMOBILE' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1998-03-01' AND l_shipdate > date '1997-03-06' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('FOB', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1994-05-28' AND l_receiptdate < date '1994-05-28' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%requests%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1992-01-23', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%navajo%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1993-01-20' AND L_SHIPDATE < date '1993-01-20' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'RUSSIA' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1995-10-18' AND l_shipdate < date '1995-10-18' + interval '1' year AND l_discount between 0.02-1 AND 0.06+1 AND l_quantity < 27


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 50) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1993-06-27' AND l_shipdate < date '1993-06-27' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'JORDAN') OR (NA.N_NAME = 'JORDAN' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1998-07-19' AND date '1998-07-19' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'KENYA' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#11' and p_container in ('SM DRUM', 'WRAP CASE', 'MED CAN', 'WRAP BOX') and l_quantity >= 49 and l_quantity <= 42 + 10 and p_size between 5 and 50 + 15 and l_shipmode in ('AIR', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('JUMBO BOX', 'LG PKG', 'MED BAG', 'JUMBO BOX') and l_quantity >= 26 and l_quantity <= 50 + 10 and p_size between 42 and 22 + 15 and l_shipmode in ('FOB', 'SHIP') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#35' and p_container in ('MED PKG', 'MED CAN', 'MED BAG', 'SM PKG') and l_quantity >= 29 and l_quantity <= 8 + 10 and p_size between 35 and 48 + 15 and l_shipmode in ('AIR', 'MAIL') and l_shipinstruct = 'NONE' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1995-10-18' AND l_shipdate < date '1995-10-18' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1998-06-01' AND date '1998-06-01' + interval '1' year AND P_TYPE= 'LARGE PLATED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '30', '21', '10', '12', '22', '21') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('20', '15', '20', '16', '32', '30', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1992-09-09' and o_orderdate < adddate('1992-09-09', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#55' and p_type like '%MEDIUM BURNISHED COPPER%' and p_size in (33, 42, 36, 39, 10, 6, 11, 32) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%even%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%chocolate%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1994-11-06' AND o_orderdate < date '1994-11-06' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#45' AND P_CONTAINER = 'SM DRUM' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1996-05-03' AND O_ORDERDATE < date '1996-05-03' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 29 AND P_TYPE LIKE '%%ECONOMY PLATED STEEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'FRANCE' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAN') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'FURNITURE' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1994-07-06' AND l_shipdate > date '1996-07-16' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('REG AIR', 'TRUCK') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1995-03-10' AND l_receiptdate < date '1995-03-10' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%final%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1996-08-01', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%sky%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-04-26' AND L_SHIPDATE < date '1996-04-26' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1992-04-03' AND l_shipdate < date '1992-04-03' + interval '1' year AND l_discount between 0.06-1 AND 0.02+1 AND l_quantity < 50


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 26) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1997-05-01' AND l_shipdate < date '1997-05-01' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'MOROCCO') OR (NA.N_NAME = 'MOROCCO' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1997-02-02' AND date '1997-02-02' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('WRAP CAN', 'LG DRUM', 'JUMBO CAN', 'MED PKG') and l_quantity >= 13 and l_quantity <= 48 + 10 and p_size between 32 and 18 + 15 and l_shipmode in ('MAIL', 'SHIP') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('SM PACK', 'MED JAR', 'JUMBO BOX', 'MED JAR') and l_quantity >= 44 and l_quantity <= 13 + 10 and p_size between 28 and 49 + 15 and l_shipmode in ('AIR', 'AIR') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('MED PACK', 'LG CAN', 'WRAP DRUM', 'LG BOX') and l_quantity >= 4 and l_quantity <= 29 + 10 and p_size between 11 and 50 + 15 and l_shipmode in ('MAIL', 'REG AIR') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1996-04-14' AND l_shipdate < date '1996-04-14' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '30', '21', '10', '12', '22', '21') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('20', '15', '20', '16', '32', '30', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1992-12-30' and o_orderdate < adddate('1992-12-30', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#51' and p_type like '%LARGE BURNISHED BRASS%' and p_size in (30, 22, 44, 14, 27, 8, 9, 6) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%even%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%chocolate%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1996-10-14' AND o_orderdate < date '1996-10-14' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#14' AND P_CONTAINER = 'LG PACK' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1995-09-25' AND O_ORDERDATE < date '1995-09-25' + interval '3' month AND L_RETURNFLAG = 'A' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 5 AND P_TYPE LIKE '%%MEDIUM BRUSHED BRASS' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ALGERIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAN') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'FURNITURE' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1994-05-19' AND l_shipdate > date '1994-09-01' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('MAIL', 'FOB') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1997-11-30' AND l_receiptdate < date '1997-11-30' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%cajole%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1994-11-15', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%cornflower%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1998-05-19' AND L_SHIPDATE < date '1998-05-19' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'BRAZIL' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1996-02-26' AND l_shipdate < date '1996-02-26' + interval '1' year AND l_discount between 0.07-1 AND 0.03+1 AND l_quantity < 16


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 26) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-02-06' AND l_shipdate < date '1995-02-06' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'INDONESIA') OR (NA.N_NAME = 'INDONESIA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1995-02-20' AND date '1995-02-20' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'FRANCE' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#33' and p_container in ('JUMBO JAR', 'LG CAN', 'JUMBO PKG', 'WRAP CAN') and l_quantity >= 31 and l_quantity <= 29 + 10 and p_size between 31 and 10 + 15 and l_shipmode in ('SHIP', 'REG AIR') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#44' and p_container in ('WRAP CAN', 'LG CAN', 'SM CASE', 'SM PKG') and l_quantity >= 47 and l_quantity <= 29 + 10 and p_size between 46 and 35 + 15 and l_shipmode in ('FOB', 'AIR') and l_shipinstruct = 'NONE' ) or ( p_partkey = l_partkey and p_brand = 'Brand#11' and p_container in ('WRAP PACK', 'MED CAN', 'JUMBO PACK', 'LG PACK') and l_quantity >= 27 and l_quantity <= 14 + 10 and p_size between 1 and 16 + 15 and l_shipmode in ('RAIL', 'AIR') and l_shipinstruct = 'COLLECT COD' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1996-06-29' AND l_shipdate < date '1996-06-29' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-10-01' AND date '1995-10-01' + interval '1' year AND P_TYPE= 'LARGE POLISHED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('11', '18', '31', '18', '17', '19', '31') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('27', '27', '25', '21', '18', '32', '12') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1997-09-22' and o_orderdate < adddate('1997-09-22', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#15' and p_type like '%ECONOMY POLISHED NICKEL%' and p_size in (33, 12, 17, 22, 13, 31, 47, 7) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%are%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%chocolate%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1995-03-23' AND o_orderdate < date '1995-03-23' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#33' AND P_CONTAINER = 'JUMBO BOX' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1997-04-22' AND O_ORDERDATE < date '1997-04-22' + interval '3' month AND L_RETURNFLAG = 'R' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 2 AND P_TYPE LIKE '%%LARGE POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ETHIOPIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'RUSSIA') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'FURNITURE' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1994-08-23' AND l_shipdate > date '1997-06-07' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('MAIL', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-05-10' AND l_receiptdate < date '1996-05-10' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%final%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1997-01-02', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%ghost%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-10-26' AND L_SHIPDATE < date '1996-10-26' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'VIETNAM' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1992-07-07' AND l_shipdate < date '1992-07-07' + interval '1' year AND l_discount between 0.04-1 AND 0.03+1 AND l_quantity < 43


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 29) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1993-01-03' AND l_shipdate < date '1993-01-03' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'JORDAN') OR (NA.N_NAME = 'JORDAN' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1993-02-17' AND date '1993-02-17' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'O' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'INDONESIA' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('JUMBO BOX', 'LG PKG', 'LG CAN', 'JUMBO JAR') and l_quantity >= 36 and l_quantity <= 47 + 10 and p_size between 31 and 11 + 15 and l_shipmode in ('MAIL', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('SM DRUM', 'WRAP BOX', 'SM DRUM', 'WRAP CASE') and l_quantity >= 47 and l_quantity <= 11 + 10 and p_size between 47 and 5 + 15 and l_shipmode in ('REG AIR', 'RAIL') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('WRAP BAG', 'MED PKG', 'WRAP PACK', 'LG CAN') and l_quantity >= 4 and l_quantity <= 20 + 10 and p_size between 20 and 21 + 15 and l_shipmode in ('FOB', 'SHIP') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1998-04-30' AND l_shipdate < date '1998-04-30' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-09-22' AND date '1995-09-22' + interval '1' year AND P_TYPE= 'SMALL ANODIZED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('31', '16', '31', '31', '20', '11', '32') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('10', '31', '18', '31', '26', '17', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-06-22' and o_orderdate < adddate('1994-06-22', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#33' and p_type like '%SMALL PLATED NICKEL%' and p_size in (37, 48, 49, 15, 38, 11, 47, 8) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%slyly%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%honeydew%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1995-03-23' AND o_orderdate < date '1995-03-23' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#31' AND P_CONTAINER = 'MED CAN' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-12-15' AND O_ORDERDATE < date '1992-12-15' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 35 AND P_TYPE LIKE '%%STANDARD PLATED TIN' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'INDONESIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'CHINA') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-09-21' AND l_shipdate > date '1993-05-16' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('MAIL', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-05-10' AND l_receiptdate < date '1996-05-10' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%haggle%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1992-12-06', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%sky%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-04-26' AND L_SHIPDATE < date '1996-04-26' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1997-08-01' AND l_shipdate < date '1997-08-01' + interval '1' year AND l_discount between 0.1-1 AND 0.01+1 AND l_quantity < 24


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 6) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-05-03' AND l_shipdate < date '1995-05-03' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'ETHIOPIA') OR (NA.N_NAME = 'ETHIOPIA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1997-10-29' AND date '1997-10-29' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('MED BAG', 'WRAP PACK', 'MED BOX', 'MED BOX') and l_quantity >= 47 and l_quantity <= 12 + 10 and p_size between 13 and 47 + 15 and l_shipmode in ('REG AIR', 'TRUCK') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('SM BAG', 'SM PACK', 'LG PACK', 'MED BAG') and l_quantity >= 39 and l_quantity <= 16 + 10 and p_size between 48 and 22 + 15 and l_shipmode in ('MAIL', 'RAIL') and l_shipinstruct = 'NONE' ) or ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('LG BOX', 'SM PACK', 'JUMBO PACK', 'JUMBO JAR') and l_quantity >= 50 and l_quantity <= 34 + 10 and p_size between 37 and 31 + 15 and l_shipmode in ('TRUCK', 'REG AIR') and l_shipinstruct = 'COLLECT COD' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1996-11-09' AND l_shipdate < date '1996-11-09' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-03-16' AND date '1993-03-16' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '30', '21', '10', '12', '22', '21') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('20', '15', '20', '16', '32', '30', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-06-22' and o_orderdate < adddate('1994-06-22', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#32' and p_type like '%ECONOMY BURNISHED BRASS%' and p_size in (9, 24, 47, 28, 1, 16, 35, 5) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%blithely%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%midnight%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1993-02-12' AND o_orderdate < date '1993-02-12' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#55' AND P_CONTAINER = 'WRAP PACK' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)

/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1993-01-13' AND O_ORDERDATE < date '1993-01-13' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20

/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 17 AND P_TYPE LIKE '%%ECONOMY PLATED STEEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100

/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ROMANIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO') ORDER BY VALUE DESC

/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-09-21' AND l_shipdate > date '1993-05-16' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20

/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('MAIL', 'MAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-02-27' AND l_receiptdate < date '1996-02-27' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode

/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%quickly%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC

/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1993-03-03', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus

/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%sky%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-04-26' AND L_SHIPDATE < date '1996-04-26' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' ORDER BY S_NAME

/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1997-02-07' AND l_shipdate < date '1997-02-07' + interval '1' year AND l_discount between 0.06-1 AND 0.01+1 AND l_quantity < 35

/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 30) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100

/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1993-02-16' AND l_shipdate < date '1993-02-16' + interval '1' month

/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'PERU') OR (NA.N_NAME = 'PERU' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1994-09-29' AND date '1994-09-29' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR

/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'P' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'SAUDI ARABIA' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100

/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#32' and p_container in ('SM PKG', 'SM PKG', 'SM BOX', 'MED PACK') and l_quantity >= 30 and l_quantity <= 22 + 10 and p_size between 41 and 21 + 15 and l_shipmode in ('REG AIR', 'RAIL') and l_shipinstruct = 'NONE' ) or ( p_partkey = l_partkey and p_brand = 'Brand#25' and p_container in ('SM DRUM', 'WRAP BOX', 'LG PKG', 'MED JAR') and l_quantity >= 43 and l_quantity <= 35 + 10 and p_size between 45 and 11 + 15 and l_shipmode in ('FOB', 'MAIL') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#34' and p_container in ('LG PACK', 'LG DRUM', 'WRAP CAN', 'JUMBO PKG') and l_quantity >= 7 and l_quantity <= 45 + 10 and p_size between 42 and 38 + 15 and l_shipmode in ('TRUCK', 'AIR') and l_shipinstruct = 'DELIVER IN PERSON' )

/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1994-10-30' AND l_shipdate < date '1994-10-30' + interval '3' MONTH GROUP BY l_suppkey

/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1992-03-20' AND date '1992-03-20' + interval '1' year AND P_TYPE= 'ECONOMY BRUSHED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR

/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('21', '34', '10', '27', '34', '28', '24') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('25', '11', '24', '21', '14', '34', '10') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode

/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-06-22' and o_orderdate < adddate('1994-06-22', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority

/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#45' and p_type like '%MEDIUM BURNISHED STEEL%' and p_size in (14, 26, 40, 46, 29, 6, 21, 40) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%pending%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size

/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%pink%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC

/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1997-12-07' AND o_orderdate < date '1997-12-07' + interval '1' year GROUP BY n_name ORDER BY revenue desc

/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#12' AND P_CONTAINER = 'JUMBO BAG' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1996-04-16' AND O_ORDERDATE < date '1996-04-16' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 10 AND P_TYPE LIKE '%%PROMO POLISHED BRASS' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'JORDAN' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED STATES') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-10-28' AND l_shipdate > date '1998-05-14' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('SHIP', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1992-09-20' AND l_receiptdate < date '1992-09-20' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%accounts%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1992-12-06', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%sky%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-04-26' AND L_SHIPDATE < date '1996-04-26' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1994-09-18' AND l_shipdate < date '1994-09-18' + interval '1' year AND l_discount between 0.01-1 AND 0.03+1 AND l_quantity < 16


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 26) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-05-29' AND l_shipdate < date '1992-05-29' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'UNITED STATES') OR (NA.N_NAME = 'UNITED STATES' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1995-10-26' AND date '1995-10-26' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ROMANIA' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('WRAP CASE', 'JUMBO JAR', 'MED JAR', 'JUMBO JAR') and l_quantity >= 40 and l_quantity <= 1 + 10 and p_size between 38 and 39 + 15 and l_shipmode in ('MAIL', 'TRUCK') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#53' and p_container in ('JUMBO CAN', 'MED CAN', 'MED JAR', 'WRAP DRUM') and l_quantity >= 37 and l_quantity <= 29 + 10 and p_size between 17 and 26 + 15 and l_shipmode in ('TRUCK', 'MAIL') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('WRAP PACK', 'LG CAN', 'MED CASE', 'SM PKG') and l_quantity >= 50 and l_quantity <= 14 + 10 and p_size between 37 and 22 + 15 and l_shipmode in ('SHIP', 'MAIL') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1994-10-30' AND l_shipdate < date '1994-10-30' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('16', '18', '29', '22', '32', '17', '25') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('12', '12', '27', '18', '18', '26', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-06-22' and o_orderdate < adddate('1994-06-22', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#54' and p_type like '%SMALL BRUSHED NICKEL%' and p_size in (44, 34, 1, 11, 18, 17, 27, 9) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%furiously%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%navajo%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'AFRICA' AND o_orderdate >= date '1992-07-29' AND o_orderdate < date '1992-07-29' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#14' AND P_CONTAINER = 'SM PACK' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1993-04-24' AND O_ORDERDATE < date '1993-04-24' + interval '3' month AND L_RETURNFLAG = 'A' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 19 AND P_TYPE LIKE '%%STANDARD PLATED BRASS' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'BRAZIL' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'GERMANY') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1992-12-12' AND l_shipdate > date '1995-08-06' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('AIR', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1998-07-31' AND l_receiptdate < date '1998-07-31' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%haggle%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1996-10-15', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%pale%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-02-27' AND L_SHIPDATE < date '1996-02-27' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1995-12-18' AND l_shipdate < date '1995-12-18' + interval '1' year AND l_discount between 0.02-1 AND 0.03+1 AND l_quantity < 43


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 13) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-09-03' AND l_shipdate < date '1992-09-03' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'FRANCE') OR (NA.N_NAME = 'FRANCE' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1994-08-31' AND date '1994-08-31' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'FRANCE' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('JUMBO BOX', 'LG PKG', 'LG CAN', 'JUMBO JAR') and l_quantity >= 36 and l_quantity <= 47 + 10 and p_size between 31 and 11 + 15 and l_shipmode in ('MAIL', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('SM DRUM', 'WRAP BOX', 'SM DRUM', 'WRAP CASE') and l_quantity >= 47 and l_quantity <= 11 + 10 and p_size between 47 and 5 + 15 and l_shipmode in ('REG AIR', 'RAIL') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('WRAP BAG', 'MED PKG', 'WRAP PACK', 'LG CAN') and l_quantity >= 4 and l_quantity <= 20 + 10 and p_size between 20 and 21 + 15 and l_shipmode in ('FOB', 'SHIP') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1994-10-30' AND l_shipdate < date '1994-10-30' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-09-16' AND date '1993-09-16' + interval '1' year AND P_TYPE= 'ECONOMY PLATED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('14', '17', '31', '17', '27', '24', '10') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('33', '26', '32', '28', '31', '19', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-09-21' and o_orderdate < adddate('1994-09-21', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#43' and p_type like '%ECONOMY ANODIZED COPPER%' and p_size in (2, 40, 15, 19, 6, 7, 13, 49) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%pinto%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%chocolate%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND o_orderdate >= date '1996-02-07' AND o_orderdate < date '1996-02-07' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#23' AND P_CONTAINER = 'SM DRUM' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1997-08-28' AND O_ORDERDATE < date '1997-08-28' + interval '3' month AND L_RETURNFLAG = 'A' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 23 AND P_TYPE LIKE '%%ECONOMY POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'KENYA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOZAMBIQUE') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1992-04-27' AND l_shipdate > date '1996-11-01' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('MAIL', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-05-10' AND l_receiptdate < date '1996-05-10' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%haggle%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1992-12-06', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%sky%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-04-26' AND L_SHIPDATE < date '1996-04-26' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1992-04-09' AND l_shipdate < date '1992-04-09' + interval '1' year AND l_discount between 0.0-1 AND 0.06+1 AND l_quantity < 13


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 20) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-09-03' AND l_shipdate < date '1992-09-03' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'MOROCCO') OR (NA.N_NAME = 'MOROCCO' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1995-03-08' AND date '1995-03-08' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ETHIOPIA' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('JUMBO BOX', 'LG PKG', 'LG CAN', 'JUMBO JAR') and l_quantity >= 36 and l_quantity <= 47 + 10 and p_size between 31 and 11 + 15 and l_shipmode in ('MAIL', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('SM DRUM', 'WRAP BOX', 'SM DRUM', 'WRAP CASE') and l_quantity >= 47 and l_quantity <= 11 + 10 and p_size between 47 and 5 + 15 and l_shipmode in ('REG AIR', 'RAIL') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('WRAP BAG', 'MED PKG', 'WRAP PACK', 'LG CAN') and l_quantity >= 4 and l_quantity <= 20 + 10 and p_size between 20 and 21 + 15 and l_shipmode in ('FOB', 'SHIP') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1992-12-15' AND l_shipdate < date '1992-12-15' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1998-02-26' AND date '1998-02-26' + interval '1' year AND P_TYPE= 'ECONOMY BURNISHED TIN') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '13', '34', '32', '34', '31', '32') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('28', '26', '34', '28', '21', '11', '15') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-06-22' and o_orderdate < adddate('1994-06-22', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#51' and p_type like '%LARGE BURNISHED BRASS%' and p_size in (30, 22, 44, 14, 27, 8, 9, 6) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%even%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%moccasin%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= date '1995-12-27' AND o_orderdate < date '1995-12-27' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#11' AND P_CONTAINER = 'MED BOX' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-05-28' AND O_ORDERDATE < date '1992-05-28' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 18 AND P_TYPE LIKE '%%LARGE POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'SAUDI ARABIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1994-01-29' AND l_shipdate > date '1998-08-12' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('RAIL', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-11-06' AND l_receiptdate < date '1996-11-06' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%carefully%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1998-08-17', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%midnight%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1993-06-23' AND L_SHIPDATE < date '1993-06-23' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'KENYA' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1993-09-22' AND l_shipdate < date '1993-09-22' + interval '1' year AND l_discount between 0.03-1 AND 0.06+1 AND l_quantity < 30


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 45) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-02-14' AND l_shipdate < date '1995-02-14' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'PERU') OR (NA.N_NAME = 'PERU' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1994-09-29' AND date '1994-09-29' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'O' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED STATES' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('JUMBO BOX', 'LG PKG', 'LG CAN', 'JUMBO JAR') and l_quantity >= 36 and l_quantity <= 47 + 10 and p_size between 31 and 11 + 15 and l_shipmode in ('MAIL', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('SM DRUM', 'WRAP BOX', 'SM DRUM', 'WRAP CASE') and l_quantity >= 47 and l_quantity <= 11 + 10 and p_size between 47 and 5 + 15 and l_shipmode in ('REG AIR', 'RAIL') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('WRAP BAG', 'MED PKG', 'WRAP PACK', 'LG CAN') and l_quantity >= 4 and l_quantity <= 20 + 10 and p_size between 20 and 21 + 15 and l_shipmode in ('FOB', 'SHIP') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1995-05-05' AND l_shipdate < date '1995-05-05' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-02-14' AND date '1995-02-14' + interval '1' year AND P_TYPE= 'ECONOMY BRUSHED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('17', '22', '26', '26', '15', '22', '11') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('19', '24', '16', '22', '13', '17', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1995-11-19' and o_orderdate < adddate('1995-11-19', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#51' and p_type like '%LARGE BURNISHED BRASS%' and p_size in (30, 22, 44, 14, 27, 8, 9, 6) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%even%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%chocolate%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1994-10-26' AND o_orderdate < date '1994-10-26' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#23' AND P_CONTAINER = 'SM DRUM' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1994-12-17' AND O_ORDERDATE < date '1994-12-17' + interval '3' month AND L_RETURNFLAG = 'A' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 33 AND P_TYPE LIKE '%%ECONOMY BURNISHED BRASS' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOZAMBIQUE' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'FRANCE') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'FURNITURE' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1995-08-28' AND l_shipdate > date '1998-01-04' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('MAIL', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-05-10' AND l_receiptdate < date '1996-05-10' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%are%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1992-12-06', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%cornsilk%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1992-08-30' AND L_SHIPDATE < date '1992-08-30' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED STATES' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1995-12-18' AND l_shipdate < date '1995-12-18' + interval '1' year AND l_discount between 0.02-1 AND 0.03+1 AND l_quantity < 43


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 30) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-09-03' AND l_shipdate < date '1992-09-03' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'SAUDI ARABIA') OR (NA.N_NAME = 'SAUDI ARABIA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1992-03-01' AND date '1992-03-01' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'P' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'FRANCE' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#35' and p_container in ('JUMBO JAR', 'MED CAN', 'LG PKG', 'WRAP CAN') and l_quantity >= 29 and l_quantity <= 9 + 10 and p_size between 23 and 2 + 15 and l_shipmode in ('TRUCK', 'TRUCK') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#34' and p_container in ('LG BOX', 'MED CAN', 'SM PACK', 'SM PKG') and l_quantity >= 17 and l_quantity <= 31 + 10 and p_size between 14 and 28 + 15 and l_shipmode in ('AIR', 'SHIP') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#53' and p_container in ('LG CAN', 'LG CAN', 'SM DRUM', 'JUMBO BOX') and l_quantity >= 8 and l_quantity <= 2 + 10 and p_size between 39 and 12 + 15 and l_shipmode in ('MAIL', 'MAIL') and l_shipinstruct = 'NONE' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1995-10-27' AND l_shipdate < date '1995-10-27' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-12-05' AND date '1993-12-05' + interval '1' year AND P_TYPE= 'ECONOMY BRUSHED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '30', '21', '10', '12', '22', '21') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('20', '15', '20', '16', '32', '30', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-06-22' and o_orderdate < adddate('1994-06-22', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#35' and p_type like '%MEDIUM BRUSHED TIN%' and p_size in (41, 12, 26, 31, 3, 17, 32, 16) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%carefully%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%medium%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'AMERICA' AND o_orderdate >= date '1997-12-11' AND o_orderdate < date '1997-12-11' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#23' AND P_CONTAINER = 'SM DRUM' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1998-06-05' AND O_ORDERDATE < date '1998-06-05' + interval '3' month AND L_RETURNFLAG = 'R' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 14 AND P_TYPE LIKE '%%ECONOMY BURNISHED TIN' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ETHIOPIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ALGERIA') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-09-21' AND l_shipdate > date '1993-05-16' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('SHIP', 'AIR') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1992-07-18' AND l_receiptdate < date '1992-07-18' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%accounts%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1992-12-06', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%purple%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1997-07-21' AND L_SHIPDATE < date '1997-07-21' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'CHINA' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1995-12-18' AND l_shipdate < date '1995-12-18' + interval '1' year AND l_discount between 0.02-1 AND 0.03+1 AND l_quantity < 43


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 26) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1994-04-05' AND l_shipdate < date '1994-04-05' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'MOZAMBIQUE') OR (NA.N_NAME = 'MOZAMBIQUE' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1998-04-02' AND date '1998-04-02' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#33' and p_container in ('MED BAG', 'LG BOX', 'SM PACK', 'LG BOX') and l_quantity >= 2 and l_quantity <= 37 + 10 and p_size between 29 and 32 + 15 and l_shipmode in ('MAIL', 'MAIL') and l_shipinstruct = 'NONE' ) or ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('WRAP BAG', 'WRAP BAG', 'MED JAR', 'LG PKG') and l_quantity >= 17 and l_quantity <= 31 + 10 and p_size between 14 and 23 + 15 and l_shipmode in ('RAIL', 'SHIP') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#32' and p_container in ('LG PACK', 'MED PACK', 'JUMBO BOX', 'WRAP PACK') and l_quantity >= 7 and l_quantity <= 15 + 10 and p_size between 16 and 36 + 15 and l_shipmode in ('RAIL', 'MAIL') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1993-03-13' AND l_shipdate < date '1993-03-13' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1994-01-21' AND date '1994-01-21' + interval '1' year AND P_TYPE= 'MEDIUM BRUSHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '30', '21', '10', '12', '22', '21') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('20', '15', '20', '16', '32', '30', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-01-25' and o_orderdate < adddate('1996-01-25', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#53' and p_type like '%MEDIUM POLISHED NICKEL%' and p_size in (25, 42, 18, 11, 2, 3, 18, 32) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%carefully%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%firebrick%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1995-03-23' AND o_orderdate < date '1995-03-23' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#35' AND P_CONTAINER = 'MED CAN' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-12-15' AND O_ORDERDATE < date '1992-12-15' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 2 AND P_TYPE LIKE '%%LARGE POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'INDONESIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOZAMBIQUE') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-09-21' AND l_shipdate > date '1993-05-16' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('TRUCK', 'MAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1994-04-04' AND l_receiptdate < date '1994-04-04' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%haggle%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1994-08-05', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%purple%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-08-25' AND L_SHIPDATE < date '1996-08-25' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'JORDAN' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1995-12-18' AND l_shipdate < date '1995-12-18' + interval '1' year AND l_discount between 0.02-1 AND 0.03+1 AND l_quantity < 43


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 1) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-09-03' AND l_shipdate < date '1992-09-03' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'PERU') OR (NA.N_NAME = 'PERU' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1994-09-29' AND date '1994-09-29' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'O' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'RUSSIA' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#35' and p_container in ('WRAP PKG', 'WRAP BAG', 'MED CAN', 'MED CAN') and l_quantity >= 47 and l_quantity <= 8 + 10 and p_size between 11 and 2 + 15 and l_shipmode in ('REG AIR', 'REG AIR') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#25' and p_container in ('LG BOX', 'SM BAG', 'WRAP BAG', 'JUMBO BAG') and l_quantity >= 45 and l_quantity <= 1 + 10 and p_size between 45 and 23 + 15 and l_shipmode in ('REG AIR', 'MAIL') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('WRAP DRUM', 'WRAP DRUM', 'MED DRUM', 'JUMBO PACK') and l_quantity >= 17 and l_quantity <= 18 + 10 and p_size between 2 and 47 + 15 and l_shipmode in ('SHIP', 'REG AIR') and l_shipinstruct = 'NONE' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1998-11-02' AND l_shipdate < date '1998-11-02' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1997-05-25' AND date '1997-05-25' + interval '1' year AND P_TYPE= 'SMALL BRUSHED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('21', '30', '24', '15', '28', '33', '23') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('10', '15', '32', '25', '19', '30', '12') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1995-11-26' and o_orderdate < adddate('1995-11-26', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#55' and p_type like '%ECONOMY BRUSHED COPPER%' and p_size in (12, 32, 16, 34, 30, 47, 28, 28) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%deposits%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%chocolate%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1996-01-30' AND o_orderdate < date '1996-01-30' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#35' AND P_CONTAINER = 'SM BOX' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-12-15' AND O_ORDERDATE < date '1992-12-15' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 2 AND P_TYPE LIKE '%%LARGE POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'MACHINERY' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1993-10-29' AND l_shipdate > date '1997-05-14' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('REG AIR', 'AIR') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1993-05-25' AND l_receiptdate < date '1993-05-25' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%haggle%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1992-12-06', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%drab%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1998-04-24' AND L_SHIPDATE < date '1998-04-24' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED KINGDOM' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1993-08-16' AND l_shipdate < date '1993-08-16' + interval '1' year AND l_discount between 0.08-1 AND 0.07+1 AND l_quantity < 48


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 31) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1994-09-27' AND l_shipdate < date '1994-09-27' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'ETHIOPIA') OR (NA.N_NAME = 'ETHIOPIA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1992-09-28' AND date '1992-09-28' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('WRAP BAG', 'JUMBO JAR', 'MED BOX', 'JUMBO PKG') and l_quantity >= 50 and l_quantity <= 39 + 10 and p_size between 17 and 48 + 15 and l_shipmode in ('RAIL', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('SM CASE', 'WRAP DRUM', 'MED BOX', 'MED DRUM') and l_quantity >= 28 and l_quantity <= 36 + 10 and p_size between 45 and 20 + 15 and l_shipmode in ('MAIL', 'SHIP') and l_shipinstruct = 'NONE' ) or ( p_partkey = l_partkey and p_brand = 'Brand#21' and p_container in ('JUMBO BAG', 'MED JAR', 'LG PKG', 'SM PKG') and l_quantity >= 46 and l_quantity <= 18 + 10 and p_size between 2 and 39 + 15 and l_shipmode in ('TRUCK', 'AIR') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1996-12-27' AND l_shipdate < date '1996-12-27' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('34', '32', '11', '25', '23', '15', '10') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('33', '20', '26', '24', '13', '17', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1992-01-19' and o_orderdate < adddate('1992-01-19', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#51' and p_type like '%LARGE BURNISHED BRASS%' and p_size in (30, 22, 44, 14, 27, 8, 9, 6) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%even%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%cornsilk%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1995-03-23' AND o_orderdate < date '1995-03-23' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#24' AND P_CONTAINER = 'WRAP PKG' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-12-15' AND O_ORDERDATE < date '1992-12-15' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 41 AND P_TYPE LIKE '%%STANDARD PLATED BRASS' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ROMANIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'GERMANY') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-09-21' AND l_shipdate > date '1993-05-16' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('REG AIR', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1997-09-10' AND l_receiptdate < date '1997-09-10' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%pinto%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1997-07-29', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%sky%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-04-26' AND L_SHIPDATE < date '1996-04-26' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1992-04-24' AND l_shipdate < date '1992-04-24' + interval '1' year AND l_discount between 0.08-1 AND 0.04+1 AND l_quantity < 40


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 17) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-08-21' AND l_shipdate < date '1995-08-21' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'PERU') OR (NA.N_NAME = 'PERU' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1994-09-29' AND date '1994-09-29' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED STATES' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('JUMBO BOX', 'LG PKG', 'LG CAN', 'JUMBO JAR') and l_quantity >= 36 and l_quantity <= 47 + 10 and p_size between 31 and 11 + 15 and l_shipmode in ('MAIL', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('SM DRUM', 'WRAP BOX', 'SM DRUM', 'WRAP CASE') and l_quantity >= 47 and l_quantity <= 11 + 10 and p_size between 47 and 5 + 15 and l_shipmode in ('REG AIR', 'RAIL') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('WRAP BAG', 'MED PKG', 'WRAP PACK', 'LG CAN') and l_quantity >= 4 and l_quantity <= 20 + 10 and p_size between 20 and 21 + 15 and l_shipmode in ('FOB', 'SHIP') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1998-02-17' AND l_shipdate < date '1998-02-17' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-10-30' AND date '1993-10-30' + interval '1' year AND P_TYPE= 'ECONOMY BURNISHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('25', '34', '16', '20', '28', '28', '22') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('14', '16', '28', '30', '11', '23', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-06-09' and o_orderdate < adddate('1994-06-09', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#31' and p_type like '%ECONOMY POLISHED NICKEL%' and p_size in (39, 8, 37, 28, 22, 37, 17, 19) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%final%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%orchid%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'AFRICA' AND o_orderdate >= date '1996-01-31' AND o_orderdate < date '1996-01-31' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#34' AND P_CONTAINER = 'JUMBO BOX' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-12-15' AND O_ORDERDATE < date '1992-12-15' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 50 AND P_TYPE LIKE '%%MEDIUM BURNISHED STEEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED KINGDOM' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED STATES') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1994-11-11' AND l_shipdate > date '1995-05-28' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('TRUCK', 'AIR') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1993-05-17' AND l_receiptdate < date '1993-05-17' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%furiously%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1996-01-14', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%bisque%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1992-02-21' AND L_SHIPDATE < date '1992-02-21' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'VIETNAM' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1994-06-22' AND l_shipdate < date '1994-06-22' + interval '1' year AND l_discount between 0.03-1 AND 0.07+1 AND l_quantity < 44


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 20) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-08-04' AND l_shipdate < date '1992-08-04' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'CANADA') OR (NA.N_NAME = 'CANADA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1996-04-11' AND date '1996-04-11' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#34' and p_container in ('JUMBO BAG', 'MED DRUM', 'JUMBO BOX', 'WRAP CAN') and l_quantity >= 35 and l_quantity <= 39 + 10 and p_size between 48 and 26 + 15 and l_shipmode in ('MAIL', 'MAIL') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#55' and p_container in ('MED BOX', 'WRAP PACK', 'JUMBO JAR', 'MED CAN') and l_quantity >= 39 and l_quantity <= 46 + 10 and p_size between 18 and 14 + 15 and l_shipmode in ('TRUCK', 'TRUCK') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#45' and p_container in ('WRAP PACK', 'MED DRUM', 'JUMBO BAG', 'MED DRUM') and l_quantity >= 31 and l_quantity <= 39 + 10 and p_size between 19 and 47 + 15 and l_shipmode in ('MAIL', 'SHIP') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1994-10-30' AND l_shipdate < date '1994-10-30' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1996-09-27' AND date '1996-09-27' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('34', '13', '20', '23', '26', '26', '20') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('34', '22', '21', '27', '18', '25', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-06-22' and o_orderdate < adddate('1994-06-22', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#12' and p_type like '%LARGE ANODIZED COPPER%' and p_size in (45, 13, 7, 48, 13, 43, 16, 31) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%unusual%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%chocolate%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'AMERICA' AND o_orderdate >= date '1998-02-12' AND o_orderdate < date '1998-02-12' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#23' AND P_CONTAINER = 'WRAP CAN' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-12-15' AND O_ORDERDATE < date '1992-12-15' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 2 AND P_TYPE LIKE '%%SMALL ANODIZED COPPER' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'GERMANY' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'CANADA') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'MACHINERY' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-03-15' AND l_shipdate > date '1994-01-17' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('SHIP', 'FOB') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1993-02-27' AND l_receiptdate < date '1993-02-27' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%fluffily%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1998-02-28', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%black%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1997-01-08' AND L_SHIPDATE < date '1997-01-08' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ETHIOPIA' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1996-10-20' AND l_shipdate < date '1996-10-20' + interval '1' year AND l_discount between 0.03-1 AND 0.02+1 AND l_quantity < 24


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 30) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1994-02-24' AND l_shipdate < date '1994-02-24' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'RUSSIA') OR (NA.N_NAME = 'RUSSIA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1996-09-13' AND date '1996-09-13' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'O' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'JORDAN' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('LG BOX', 'SM PACK', 'JUMBO CAN', 'MED BAG') and l_quantity >= 38 and l_quantity <= 28 + 10 and p_size between 43 and 6 + 15 and l_shipmode in ('REG AIR', 'TRUCK') and l_shipinstruct = 'NONE' ) or ( p_partkey = l_partkey and p_brand = 'Brand#44' and p_container in ('MED CASE', 'MED JAR', 'SM PACK', 'MED JAR') and l_quantity >= 19 and l_quantity <= 26 + 10 and p_size between 23 and 18 + 15 and l_shipmode in ('AIR', 'MAIL') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('SM BAG', 'MED CASE', 'SM CASE', 'SM PKG') and l_quantity >= 15 and l_quantity <= 28 + 10 and p_size between 37 and 50 + 15 and l_shipmode in ('AIR', 'MAIL') and l_shipinstruct = 'COLLECT COD' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1997-02-07' AND l_shipdate < date '1997-02-07' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1994-09-26' AND date '1994-09-26' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('16', '34', '14', '10', '20', '30', '13') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('17', '30', '22', '25', '29', '33', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1995-02-07' and o_orderdate < adddate('1995-02-07', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#13' and p_type like '%ECONOMY BURNISHED BRASS%' and p_size in (7, 2, 15, 38, 16, 36, 39, 5) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%wake%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%black%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1996-06-26' AND o_orderdate < date '1996-06-26' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#35' AND P_CONTAINER = 'JUMBO BAG' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1993-03-20' AND O_ORDERDATE < date '1993-03-20' + interval '3' month AND L_RETURNFLAG = 'R' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 2 AND P_TYPE LIKE '%%LARGE POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ROMANIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'FURNITURE' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1993-09-29' AND l_shipdate > date '1994-09-16' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('REG AIR', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1993-10-09' AND l_receiptdate < date '1993-10-09' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%express%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1998-01-08', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%cyan%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1992-12-27' AND L_SHIPDATE < date '1992-12-27' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'EGYPT' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1994-11-13' AND l_shipdate < date '1994-11-13' + interval '1' year AND l_discount between 0.02-1 AND 0.05+1 AND l_quantity < 7


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 26) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-09-03' AND l_shipdate < date '1992-09-03' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'ALGERIA') OR (NA.N_NAME = 'ALGERIA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1992-10-17' AND date '1992-10-17' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#45' and p_container in ('WRAP PACK', 'LG CAN', 'SM PKG', 'WRAP BAG') and l_quantity >= 4 and l_quantity <= 9 + 10 and p_size between 17 and 34 + 15 and l_shipmode in ('RAIL', 'AIR') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('MED DRUM', 'SM PACK', 'WRAP PKG', 'WRAP BAG') and l_quantity >= 23 and l_quantity <= 23 + 10 and p_size between 16 and 19 + 15 and l_shipmode in ('FOB', 'MAIL') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('WRAP CASE', 'MED BAG', 'JUMBO PKG', 'MED DRUM') and l_quantity >= 24 and l_quantity <= 17 + 10 and p_size between 23 and 45 + 15 and l_shipmode in ('MAIL', 'MAIL') and l_shipinstruct = 'DELIVER IN PERSON' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1994-02-04' AND l_shipdate < date '1994-02-04' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('13', '24', '21', '16', '31', '26', '31') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('21', '26', '17', '20', '24', '13', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-02-10' and o_orderdate < adddate('1996-02-10', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#45' and p_type like '%LARGE PLATED STEEL%' and p_size in (10, 14, 10, 1, 48, 4, 26, 25) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%haggle%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%blue%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'AMERICA' AND o_orderdate >= date '1994-07-15' AND o_orderdate < date '1994-07-15' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#23' AND P_CONTAINER = 'SM DRUM' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-08-15' AND O_ORDERDATE < date '1992-08-15' + interval '3' month AND L_RETURNFLAG = 'R' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 1 AND P_TYPE LIKE '%%ECONOMY PLATED STEEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED KINGDOM') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'FURNITURE' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1992-03-20' AND l_shipdate > date '1993-12-14' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('MAIL', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-05-10' AND l_receiptdate < date '1996-05-10' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%ironic%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1997-11-20', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%red%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-06-07' AND L_SHIPDATE < date '1996-06-07' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1997-11-30' AND l_shipdate < date '1997-11-30' + interval '1' year AND l_discount between 0.03-1 AND 0.09+1 AND l_quantity < 38


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 5) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-09-03' AND l_shipdate < date '1992-09-03' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'PERU') OR (NA.N_NAME = 'PERU' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1994-09-29' AND date '1994-09-29' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('MED CAN', 'WRAP CASE', 'LG BOX', 'MED DRUM') and l_quantity >= 35 and l_quantity <= 17 + 10 and p_size between 20 and 17 + 15 and l_shipmode in ('TRUCK', 'RAIL') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#25' and p_container in ('LG PACK', 'WRAP PKG', 'WRAP PACK', 'WRAP PACK') and l_quantity >= 13 and l_quantity <= 38 + 10 and p_size between 13 and 25 + 15 and l_shipmode in ('RAIL', 'SHIP') and l_shipinstruct = 'NONE' ) or ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('WRAP PACK', 'MED DRUM', 'JUMBO JAR', 'LG DRUM') and l_quantity >= 3 and l_quantity <= 6 + 10 and p_size between 25 and 13 + 15 and l_shipmode in ('RAIL', 'REG AIR') and l_shipinstruct = 'DELIVER IN PERSON' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1996-03-25' AND l_shipdate < date '1996-03-25' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-10-28' AND date '1995-10-28' + interval '1' year AND P_TYPE= 'MEDIUM BRUSHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '20', '16', '18', '27', '17', '29') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('26', '23', '29', '15', '14', '15', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1997-08-10' and o_orderdate < adddate('1997-08-10', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#52' and p_type like '%LARGE POLISHED COPPER%' and p_size in (20, 28, 41, 42, 6, 33, 3, 50) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%final%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%white%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1995-03-23' AND o_orderdate < date '1995-03-23' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#34' AND P_CONTAINER = 'MED CAN' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1997-03-10' AND O_ORDERDATE < date '1997-03-10' + interval '3' month AND L_RETURNFLAG = 'R' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 2 AND P_TYPE LIKE '%%LARGE POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'VIETNAM' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'INDIA') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'AUTOMOBILE' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1993-11-30' AND l_shipdate > date '1994-02-09' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('RAIL', 'MAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1998-09-26' AND l_receiptdate < date '1998-09-26' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%blithely%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1994-02-02', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%blue%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1997-06-30' AND L_SHIPDATE < date '1997-06-30' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'RUSSIA' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1992-06-09' AND l_shipdate < date '1992-06-09' + interval '1' year AND l_discount between 0.03-1 AND 0.01+1 AND l_quantity < 48


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 1) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-09-03' AND l_shipdate < date '1992-09-03' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'SAUDI ARABIA') OR (NA.N_NAME = 'SAUDI ARABIA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1992-08-20' AND date '1992-08-20' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'KENYA' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('JUMBO BOX', 'LG PKG', 'LG CAN', 'JUMBO JAR') and l_quantity >= 36 and l_quantity <= 47 + 10 and p_size between 31 and 11 + 15 and l_shipmode in ('MAIL', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('SM DRUM', 'WRAP BOX', 'SM DRUM', 'WRAP CASE') and l_quantity >= 47 and l_quantity <= 11 + 10 and p_size between 47 and 5 + 15 and l_shipmode in ('REG AIR', 'RAIL') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('WRAP BAG', 'MED PKG', 'WRAP PACK', 'LG CAN') and l_quantity >= 4 and l_quantity <= 20 + 10 and p_size between 20 and 21 + 15 and l_shipmode in ('FOB', 'SHIP') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1994-10-30' AND l_shipdate < date '1994-10-30' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1992-10-10' AND date '1992-10-10' + interval '1' year AND P_TYPE= 'MEDIUM BRUSHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('10', '15', '27', '27', '16', '33', '13') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('15', '19', '33', '31', '34', '14', '12') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-06-22' and o_orderdate < adddate('1994-06-22', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#45' and p_type like '%MEDIUM POLISHED NICKEL%' and p_size in (15, 12, 3, 35, 6, 42, 15, 42) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%ironic%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%sienna%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'AMERICA' AND o_orderdate >= date '1997-06-17' AND o_orderdate < date '1997-06-17' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#23' AND P_CONTAINER = 'SM DRUM' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-08-25' AND O_ORDERDATE < date '1992-08-25' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 4 AND P_TYPE LIKE '%%SMALL BRUSHED BRASS' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ROMANIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'FURNITURE' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1995-05-20' AND l_shipdate > date '1996-12-08' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('MAIL', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-05-10' AND l_receiptdate < date '1996-05-10' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%final%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1993-06-19', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%sky%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-04-26' AND L_SHIPDATE < date '1996-04-26' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1995-12-18' AND l_shipdate < date '1995-12-18' + interval '1' year AND l_discount between 0.02-1 AND 0.03+1 AND l_quantity < 43


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 2) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-11-19' AND l_shipdate < date '1995-11-19' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'ARGENTINA') OR (NA.N_NAME = 'ARGENTINA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1998-06-24' AND date '1998-06-24' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'O' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'FRANCE' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#32' and p_container in ('JUMBO BAG', 'LG DRUM', 'LG PACK', 'MED PACK') and l_quantity >= 29 and l_quantity <= 28 + 10 and p_size between 42 and 48 + 15 and l_shipmode in ('SHIP', 'AIR') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#15' and p_container in ('WRAP BAG', 'MED DRUM', 'WRAP PACK', 'SM BAG') and l_quantity >= 43 and l_quantity <= 30 + 10 and p_size between 29 and 48 + 15 and l_shipmode in ('AIR', 'AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('LG DRUM', 'LG PKG', 'SM CASE', 'SM CASE') and l_quantity >= 20 and l_quantity <= 32 + 10 and p_size between 8 and 30 + 15 and l_shipmode in ('SHIP', 'MAIL') and l_shipinstruct = 'COLLECT COD' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1993-07-25' AND l_shipdate < date '1993-07-25' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '30', '21', '10', '12', '22', '21') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('20', '15', '20', '16', '32', '30', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1995-11-03' and o_orderdate < adddate('1995-11-03', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#53' and p_type like '%SMALL ANODIZED COPPER%' and p_size in (6, 45, 5, 20, 48, 35, 42, 45) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%are%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%tomato%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1995-03-23' AND o_orderdate < date '1995-03-23' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#32' AND P_CONTAINER = 'SM BOX' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-12-15' AND O_ORDERDATE < date '1992-12-15' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 23 AND P_TYPE LIKE '%%SMALL POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ROMANIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'MACHINERY' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-09-14' AND l_shipdate > date '1995-09-03' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('AIR', 'AIR') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-12-02' AND l_receiptdate < date '1996-12-02' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%wake%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1993-11-18', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%moccasin%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1993-01-22' AND L_SHIPDATE < date '1993-01-22' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED STATES' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1995-12-18' AND l_shipdate < date '1995-12-18' + interval '1' year AND l_discount between 0.02-1 AND 0.03+1 AND l_quantity < 43


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 34) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1993-11-07' AND l_shipdate < date '1993-11-07' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'CANADA') OR (NA.N_NAME = 'CANADA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1994-12-03' AND date '1994-12-03' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'O' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#33' and p_container in ('WRAP DRUM', 'WRAP PKG', 'MED BOX', 'LG BOX') and l_quantity >= 45 and l_quantity <= 38 + 10 and p_size between 15 and 9 + 15 and l_shipmode in ('SHIP', 'TRUCK') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('MED JAR', 'MED PACK', 'MED BOX', 'JUMBO PKG') and l_quantity >= 26 and l_quantity <= 14 + 10 and p_size between 44 and 22 + 15 and l_shipmode in ('RAIL', 'REG AIR') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#25' and p_container in ('WRAP DRUM', 'LG BOX', 'MED BAG', 'JUMBO BOX') and l_quantity >= 8 and l_quantity <= 1 + 10 and p_size between 5 and 1 + 15 and l_shipmode in ('RAIL', 'REG AIR') and l_shipinstruct = 'COLLECT COD' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1994-10-30' AND l_shipdate < date '1994-10-30' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '30', '21', '10', '12', '22', '21') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('20', '15', '20', '16', '32', '30', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1992-11-15' and o_orderdate < adddate('1992-11-15', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#45' and p_type like '%STANDARD PLATED TIN%' and p_size in (12, 16, 9, 10, 14, 26, 28, 35) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%even%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%cornsilk%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= date '1993-03-03' AND o_orderdate < date '1993-03-03' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#22' AND P_CONTAINER = 'SM PACK' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-12-15' AND O_ORDERDATE < date '1992-12-15' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 34 AND P_TYPE LIKE '%%ECONOMY ANODIZED COPPER' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'RUSSIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOZAMBIQUE') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'MACHINERY' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1997-12-26' AND l_shipdate > date '1992-12-05' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('MAIL', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-05-10' AND l_receiptdate < date '1996-05-10' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%packages%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1992-12-06', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%cyan%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1992-09-16' AND L_SHIPDATE < date '1992-09-16' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'VIETNAM' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1996-01-05' AND l_shipdate < date '1996-01-05' + interval '1' year AND l_discount between 0.08-1 AND 0.01+1 AND l_quantity < 4


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 26) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-11-21' AND l_shipdate < date '1992-11-21' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'PERU') OR (NA.N_NAME = 'PERU' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1994-09-29' AND date '1994-09-29' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'O' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'JORDAN' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('JUMBO BOX', 'WRAP PACK', 'SM BOX', 'WRAP DRUM') and l_quantity >= 27 and l_quantity <= 48 + 10 and p_size between 27 and 21 + 15 and l_shipmode in ('SHIP', 'TRUCK') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('SM DRUM', 'WRAP CASE', 'LG DRUM', 'MED JAR') and l_quantity >= 10 and l_quantity <= 27 + 10 and p_size between 15 and 26 + 15 and l_shipmode in ('MAIL', 'SHIP') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('MED DRUM', 'JUMBO PKG', 'LG DRUM', 'JUMBO JAR') and l_quantity >= 12 and l_quantity <= 1 + 10 and p_size between 43 and 14 + 15 and l_shipmode in ('RAIL', 'TRUCK') and l_shipinstruct = 'NONE' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1995-04-02' AND l_shipdate < date '1995-04-02' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1998-03-05' AND date '1998-03-05' + interval '1' year AND P_TYPE= 'SMALL ANODIZED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('22', '16', '24', '17', '34', '20', '14') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('31', '31', '15', '16', '10', '27', '17') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-05-03' and o_orderdate < adddate('1996-05-03', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#33' and p_type like '%SMALL BRUSHED NICKEL%' and p_size in (35, 12, 45, 5, 24, 17, 24, 5) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%pending%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%chocolate%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1995-03-23' AND o_orderdate < date '1995-03-23' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#41' AND P_CONTAINER = 'WRAP CASE' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1995-09-28' AND O_ORDERDATE < date '1995-09-28' + interval '3' month AND L_RETURNFLAG = 'R' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 2 AND P_TYPE LIKE '%%LARGE POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'BRAZIL') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-09-21' AND l_shipdate > date '1993-05-16' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('AIR', 'FOB') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1998-12-09' AND l_receiptdate < date '1998-12-09' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%haggle%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1992-09-29', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%pink%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1994-02-24' AND L_SHIPDATE < date '1994-02-24' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'JORDAN' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1994-11-28' AND l_shipdate < date '1994-11-28' + interval '1' year AND l_discount between 0.01-1 AND 0.09+1 AND l_quantity < 48


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 26) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1994-10-08' AND l_shipdate < date '1994-10-08' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'MOZAMBIQUE') OR (NA.N_NAME = 'MOZAMBIQUE' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1995-02-16' AND date '1995-02-16' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('JUMBO BOX', 'LG PKG', 'LG CAN', 'JUMBO JAR') and l_quantity >= 36 and l_quantity <= 47 + 10 and p_size between 31 and 11 + 15 and l_shipmode in ('MAIL', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('SM DRUM', 'WRAP BOX', 'SM DRUM', 'WRAP CASE') and l_quantity >= 47 and l_quantity <= 11 + 10 and p_size between 47 and 5 + 15 and l_shipmode in ('REG AIR', 'RAIL') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('WRAP BAG', 'MED PKG', 'WRAP PACK', 'LG CAN') and l_quantity >= 4 and l_quantity <= 20 + 10 and p_size between 20 and 21 + 15 and l_shipmode in ('FOB', 'SHIP') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1995-12-17' AND l_shipdate < date '1995-12-17' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('20', '26', '11', '27', '23', '33', '14') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('29', '25', '29', '21', '13', '34', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-06-05' and o_orderdate < adddate('1993-06-05', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#51' and p_type like '%LARGE BURNISHED BRASS%' and p_size in (30, 22, 44, 14, 27, 8, 9, 6) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%even%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%honeydew%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND o_orderdate >= date '1997-09-23' AND o_orderdate < date '1997-09-23' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#23' AND P_CONTAINER = 'SM DRUM' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1994-05-24' AND O_ORDERDATE < date '1994-05-24' + interval '3' month AND L_RETURNFLAG = 'R' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 43 AND P_TYPE LIKE '%%ECONOMY POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ROMANIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-09-21' AND l_shipdate > date '1993-05-16' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('FOB', 'FOB') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1992-03-24' AND l_receiptdate < date '1992-03-24' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%slyly%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1995-02-18', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%ghost%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-04-12' AND L_SHIPDATE < date '1996-04-12' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ALGERIA' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1992-09-28' AND l_shipdate < date '1992-09-28' + interval '1' year AND l_discount between 0.0-1 AND 0.05+1 AND l_quantity < 22


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 33) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1998-05-23' AND l_shipdate < date '1998-05-23' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'PERU') OR (NA.N_NAME = 'PERU' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1994-09-29' AND date '1994-09-29' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('MED BAG', 'SM PKG', 'MED BAG', 'WRAP PACK') and l_quantity >= 38 and l_quantity <= 7 + 10 and p_size between 9 and 13 + 15 and l_shipmode in ('FOB', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#21' and p_container in ('SM DRUM', 'JUMBO PACK', 'SM BAG', 'JUMBO JAR') and l_quantity >= 20 and l_quantity <= 5 + 10 and p_size between 17 and 49 + 15 and l_shipmode in ('RAIL', 'SHIP') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#15' and p_container in ('MED JAR', 'MED JAR', 'SM PKG', 'SM CASE') and l_quantity >= 42 and l_quantity <= 17 + 10 and p_size between 37 and 15 + 15 and l_shipmode in ('TRUCK', 'AIR') and l_shipinstruct = 'DELIVER IN PERSON' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1995-12-26' AND l_shipdate < date '1995-12-26' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1997-04-11' AND date '1997-04-11' + interval '1' year AND P_TYPE= 'PROMO PLATED TIN') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('30', '25', '16', '15', '14', '16', '11') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('28', '28', '22', '33', '30', '19', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-07-22' and o_orderdate < adddate('1993-07-22', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#51' and p_type like '%LARGE BURNISHED BRASS%' and p_size in (30, 22, 44, 14, 27, 8, 9, 6) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%even%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%navajo%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'EUROPE' AND o_orderdate >= date '1998-04-15' AND o_orderdate < date '1998-04-15' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#51' AND P_CONTAINER = 'SM PACK' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1995-04-14' AND O_ORDERDATE < date '1995-04-14' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 16 AND P_TYPE LIKE '%%ECONOMY POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'SAUDI ARABIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'JAPAN') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1997-12-12' AND l_shipdate > date '1994-05-31' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('MAIL', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-05-10' AND l_receiptdate < date '1996-05-10' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%haggle%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1998-02-14', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%orchid%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1993-02-15' AND L_SHIPDATE < date '1993-02-15' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'GERMANY' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1993-04-21' AND l_shipdate < date '1993-04-21' + interval '1' year AND l_discount between 0.05-1 AND 0.07+1 AND l_quantity < 26


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 29) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1998-01-01' AND l_shipdate < date '1998-01-01' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'CANADA') OR (NA.N_NAME = 'CANADA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1993-04-04' AND date '1993-04-04' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'O' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED STATES' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('WRAP PACK', 'MED BOX', 'JUMBO PACK', 'LG DRUM') and l_quantity >= 24 and l_quantity <= 37 + 10 and p_size between 31 and 34 + 15 and l_shipmode in ('TRUCK', 'TRUCK') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('MED CASE', 'LG DRUM', 'MED CASE', 'SM DRUM') and l_quantity >= 33 and l_quantity <= 11 + 10 and p_size between 25 and 44 + 15 and l_shipmode in ('FOB', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#51' and p_container in ('WRAP PACK', 'JUMBO CAN', 'WRAP BAG', 'LG PKG') and l_quantity >= 7 and l_quantity <= 26 + 10 and p_size between 50 and 23 + 15 and l_shipmode in ('TRUCK', 'FOB') and l_shipinstruct = 'DELIVER IN PERSON' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1994-10-30' AND l_shipdate < date '1994-10-30' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-03-08' AND date '1993-03-08' + interval '1' year AND P_TYPE= 'LARGE POLISHED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('18', '12', '19', '25', '10', '34', '16') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('20', '26', '26', '10', '21', '29', '12') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-08-16' and o_orderdate < adddate('1994-08-16', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#24' and p_type like '%MEDIUM ANODIZED TIN%' and p_size in (2, 23, 15, 9, 49, 32, 31, 22) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%ironic%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%navajo%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= date '1994-02-26' AND o_orderdate < date '1994-02-26' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#23' AND P_CONTAINER = 'SM DRUM' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1994-10-22' AND O_ORDERDATE < date '1994-10-22' + interval '3' month AND L_RETURNFLAG = 'A' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 32 AND P_TYPE LIKE '%%SMALL BRUSHED BRASS' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ROMANIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'BUILDING' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1992-06-09' AND l_shipdate > date '1995-10-11' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('AIR', 'REG AIR') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1993-01-21' AND l_receiptdate < date '1993-01-21' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%slyly%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1998-07-01', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%sky%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-04-26' AND L_SHIPDATE < date '1996-04-26' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1995-12-18' AND l_shipdate < date '1995-12-18' + interval '1' year AND l_discount between 0.02-1 AND 0.03+1 AND l_quantity < 43


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 26) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-09-03' AND l_shipdate < date '1992-09-03' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'INDONESIA') OR (NA.N_NAME = 'INDONESIA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1997-03-20' AND date '1997-03-20' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('LG DRUM', 'MED CASE', 'JUMBO BAG', 'SM PKG') and l_quantity >= 46 and l_quantity <= 14 + 10 and p_size between 29 and 32 + 15 and l_shipmode in ('AIR', 'TRUCK') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#15' and p_container in ('LG PACK', 'SM BAG', 'LG PKG', 'WRAP PACK') and l_quantity >= 18 and l_quantity <= 37 + 10 and p_size between 43 and 8 + 15 and l_shipmode in ('RAIL', 'FOB') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#23' and p_container in ('JUMBO PKG', 'WRAP CAN', 'MED BAG', 'MED BAG') and l_quantity >= 8 and l_quantity <= 47 + 10 and p_size between 49 and 29 + 15 and l_shipmode in ('MAIL', 'FOB') and l_shipinstruct = 'NONE' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1997-12-29' AND l_shipdate < date '1997-12-29' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1992-08-20' AND date '1992-08-20' + interval '1' year AND P_TYPE= 'MEDIUM BRUSHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('15', '12', '25', '11', '31', '23', '23') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('30', '13', '31', '32', '11', '13', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-05-21' and o_orderdate < adddate('1996-05-21', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#51' and p_type like '%LARGE BURNISHED BRASS%' and p_size in (30, 22, 44, 14, 27, 8, 9, 6) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%even%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%bisque%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1995-03-23' AND o_orderdate < date '1995-03-23' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#51' AND P_CONTAINER = 'MED DRUM' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1997-10-21' AND O_ORDERDATE < date '1997-10-21' + interval '3' month AND L_RETURNFLAG = 'R' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 37 AND P_TYPE LIKE '%%ECONOMY PLATED STEEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'CANADA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'BRAZIL') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-09-21' AND l_shipdate > date '1993-05-16' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('FOB', 'FOB') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1994-05-15' AND l_receiptdate < date '1994-05-15' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%haggle%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1993-03-12', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%orchid%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1995-02-16' AND L_SHIPDATE < date '1995-02-16' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'RUSSIA' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1995-07-24' AND l_shipdate < date '1995-07-24' + interval '1' year AND l_discount between 0.04-1 AND 0.01+1 AND l_quantity < 29


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 29) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-12-12' AND l_shipdate < date '1995-12-12' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'PERU') OR (NA.N_NAME = 'PERU' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1992-09-21' AND date '1992-09-21' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('JUMBO BOX', 'LG PKG', 'LG CAN', 'JUMBO JAR') and l_quantity >= 36 and l_quantity <= 47 + 10 and p_size between 31 and 11 + 15 and l_shipmode in ('MAIL', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('SM DRUM', 'WRAP BOX', 'SM DRUM', 'WRAP CASE') and l_quantity >= 47 and l_quantity <= 11 + 10 and p_size between 47 and 5 + 15 and l_shipmode in ('REG AIR', 'RAIL') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('WRAP BAG', 'MED PKG', 'WRAP PACK', 'LG CAN') and l_quantity >= 4 and l_quantity <= 20 + 10 and p_size between 20 and 21 + 15 and l_shipmode in ('FOB', 'SHIP') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1993-08-23' AND l_shipdate < date '1993-08-23' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1994-02-18' AND date '1994-02-18' + interval '1' year AND P_TYPE= 'LARGE BURNISHED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('15', '26', '21', '31', '15', '20', '33') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('16', '22', '19', '29', '25', '31', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1998-01-02' and o_orderdate < adddate('1998-01-02', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#51' and p_type like '%LARGE BURNISHED BRASS%' and p_size in (30, 22, 44, 14, 27, 8, 9, 6) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%even%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%sky%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'AMERICA' AND o_orderdate >= date '1993-09-30' AND o_orderdate < date '1993-09-30' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#15' AND P_CONTAINER = 'MED JAR' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1993-07-08' AND O_ORDERDATE < date '1993-07-08' + interval '3' month AND L_RETURNFLAG = 'R' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 2 AND P_TYPE LIKE '%%LARGE POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'GERMANY') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'MACHINERY' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1997-08-02' AND l_shipdate > date '1993-04-22' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('RAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1993-03-08' AND l_receiptdate < date '1993-03-08' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%requests%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1995-06-27', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%bisque%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1997-07-20' AND L_SHIPDATE < date '1997-07-20' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'UNITED KINGDOM' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1992-12-26' AND l_shipdate < date '1992-12-26' + interval '1' year AND l_discount between 0.07-1 AND 0.02+1 AND l_quantity < 13


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 4) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1992-07-10' AND l_shipdate < date '1992-07-10' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'UNITED KINGDOM') OR (NA.N_NAME = 'UNITED KINGDOM' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1993-07-22' AND date '1993-07-22' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'JORDAN' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('SM PKG', 'JUMBO JAR', 'MED JAR', 'WRAP CAN') and l_quantity >= 38 and l_quantity <= 40 + 10 and p_size between 5 and 7 + 15 and l_shipmode in ('TRUCK', 'AIR') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('LG PACK', 'MED PACK', 'MED BOX', 'JUMBO PKG') and l_quantity >= 50 and l_quantity <= 35 + 10 and p_size between 3 and 45 + 15 and l_shipmode in ('RAIL', 'MAIL') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('WRAP CAN', 'MED PKG', 'SM BOX', 'WRAP BOX') and l_quantity >= 32 and l_quantity <= 40 + 10 and p_size between 25 and 21 + 15 and l_shipmode in ('FOB', 'REG AIR') and l_shipinstruct = 'NONE' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1994-11-29' AND l_shipdate < date '1994-11-29' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('27', '28', '31', '17', '11', '22', '16') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('19', '15', '20', '26', '34', '22', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1998-07-25' and o_orderdate < adddate('1998-07-25', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#25' and p_type like '%LARGE POLISHED COPPER%' and p_size in (41, 34, 49, 18, 48, 48, 24, 46) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%regular%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%chocolate%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1997-04-29' AND o_orderdate < date '1997-04-29' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#23' AND P_CONTAINER = 'SM DRUM' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1997-06-22' AND O_ORDERDATE < date '1997-06-22' + interval '3' month AND L_RETURNFLAG = 'A' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 41 AND P_TYPE LIKE '%%ECONOMY BURNISHED BRASS' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ROMANIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1994-03-09' AND l_shipdate > date '1994-02-06' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('REG AIR', 'FOB') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1998-03-01' AND l_receiptdate < date '1998-03-01' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%accounts%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1992-12-06', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%tomato%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1997-11-23' AND L_SHIPDATE < date '1997-11-23' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'EGYPT' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1995-12-18' AND l_shipdate < date '1995-12-18' + interval '1' year AND l_discount between 0.02-1 AND 0.03+1 AND l_quantity < 43


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 16) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-04-01' AND l_shipdate < date '1995-04-01' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'PERU') OR (NA.N_NAME = 'PERU' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1994-09-29' AND date '1994-09-29' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'O' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#15' and p_container in ('SM BOX', 'WRAP CASE', 'LG CAN', 'SM BAG') and l_quantity >= 21 and l_quantity <= 25 + 10 and p_size between 32 and 3 + 15 and l_shipmode in ('FOB', 'REG AIR') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#35' and p_container in ('WRAP PKG', 'WRAP BAG', 'MED CASE', 'SM PACK') and l_quantity >= 1 and l_quantity <= 33 + 10 and p_size between 46 and 4 + 15 and l_shipmode in ('TRUCK', 'SHIP') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#32' and p_container in ('WRAP CAN', 'LG DRUM', 'JUMBO PACK', 'SM CASE') and l_quantity >= 19 and l_quantity <= 3 + 10 and p_size between 24 and 28 + 15 and l_shipmode in ('FOB', 'MAIL') and l_shipinstruct = 'NONE' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1994-10-30' AND l_shipdate < date '1994-10-30' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1998-01-03' AND date '1998-01-03' + interval '1' year AND P_TYPE= 'STANDARD PLATED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '30', '21', '10', '12', '22', '21') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('20', '15', '20', '16', '32', '30', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1992-08-29' and o_orderdate < adddate('1992-08-29', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#52' and p_type like '%ECONOMY ANODIZED STEEL%' and p_size in (43, 32, 5, 3, 1, 20, 32, 11) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%to%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%chocolate%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'ASIA' AND o_orderdate >= date '1995-03-07' AND o_orderdate < date '1995-03-07' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#23' AND P_CONTAINER = 'LG PACK' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1993-01-22' AND O_ORDERDATE < date '1993-01-22' + interval '3' month AND L_RETURNFLAG = 'A' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 2 AND P_TYPE LIKE '%%LARGE POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ROMANIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'MOROCCO') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'AUTOMOBILE' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1998-03-01' AND l_shipdate > date '1997-03-06' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('FOB', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1994-05-28' AND l_receiptdate < date '1994-05-28' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%requests%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1992-01-23', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%navajo%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1993-01-20' AND L_SHIPDATE < date '1993-01-20' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'RUSSIA' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1995-10-18' AND l_shipdate < date '1995-10-18' + interval '1' year AND l_discount between 0.02-1 AND 0.06+1 AND l_quantity < 27


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 50) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1993-06-27' AND l_shipdate < date '1993-06-27' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'JORDAN') OR (NA.N_NAME = 'JORDAN' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1998-07-19' AND date '1998-07-19' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'KENYA' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#11' and p_container in ('SM DRUM', 'WRAP CASE', 'MED CAN', 'WRAP BOX') and l_quantity >= 49 and l_quantity <= 42 + 10 and p_size between 5 and 50 + 15 and l_shipmode in ('AIR', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('JUMBO BOX', 'LG PKG', 'MED BAG', 'JUMBO BOX') and l_quantity >= 26 and l_quantity <= 50 + 10 and p_size between 42 and 22 + 15 and l_shipmode in ('FOB', 'SHIP') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#35' and p_container in ('MED PKG', 'MED CAN', 'MED BAG', 'SM PKG') and l_quantity >= 29 and l_quantity <= 8 + 10 and p_size between 35 and 48 + 15 and l_shipmode in ('AIR', 'MAIL') and l_shipinstruct = 'NONE' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1995-10-18' AND l_shipdate < date '1995-10-18' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1998-06-01' AND date '1998-06-01' + interval '1' year AND P_TYPE= 'LARGE PLATED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '30', '21', '10', '12', '22', '21') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('20', '15', '20', '16', '32', '30', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1992-09-09' and o_orderdate < adddate('1992-09-09', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#55' and p_type like '%MEDIUM BURNISHED COPPER%' and p_size in (33, 42, 36, 39, 10, 6, 11, 32) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%even%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%chocolate%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1994-11-06' AND o_orderdate < date '1994-11-06' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#45' AND P_CONTAINER = 'SM DRUM' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1996-05-03' AND O_ORDERDATE < date '1996-05-03' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 29 AND P_TYPE LIKE '%%ECONOMY PLATED STEEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'FRANCE' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAN') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'FURNITURE' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1994-07-06' AND l_shipdate > date '1996-07-16' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('REG AIR', 'TRUCK') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1995-03-10' AND l_receiptdate < date '1995-03-10' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%final%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1996-08-01', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%sky%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-04-26' AND L_SHIPDATE < date '1996-04-26' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1992-04-03' AND l_shipdate < date '1992-04-03' + interval '1' year AND l_discount between 0.06-1 AND 0.02+1 AND l_quantity < 50


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 26) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1997-05-01' AND l_shipdate < date '1997-05-01' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'MOROCCO') OR (NA.N_NAME = 'MOROCCO' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1997-02-02' AND date '1997-02-02' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('WRAP CAN', 'LG DRUM', 'JUMBO CAN', 'MED PKG') and l_quantity >= 13 and l_quantity <= 48 + 10 and p_size between 32 and 18 + 15 and l_shipmode in ('MAIL', 'SHIP') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('SM PACK', 'MED JAR', 'JUMBO BOX', 'MED JAR') and l_quantity >= 44 and l_quantity <= 13 + 10 and p_size between 28 and 49 + 15 and l_shipmode in ('AIR', 'AIR') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('MED PACK', 'LG CAN', 'WRAP DRUM', 'LG BOX') and l_quantity >= 4 and l_quantity <= 29 + 10 and p_size between 11 and 50 + 15 and l_shipmode in ('MAIL', 'REG AIR') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1996-04-14' AND l_shipdate < date '1996-04-14' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '30', '21', '10', '12', '22', '21') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('20', '15', '20', '16', '32', '30', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1992-12-30' and o_orderdate < adddate('1992-12-30', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#51' and p_type like '%LARGE BURNISHED BRASS%' and p_size in (30, 22, 44, 14, 27, 8, 9, 6) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%even%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%chocolate%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1996-10-14' AND o_orderdate < date '1996-10-14' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#14' AND P_CONTAINER = 'LG PACK' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1995-09-25' AND O_ORDERDATE < date '1995-09-25' + interval '3' month AND L_RETURNFLAG = 'A' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 5 AND P_TYPE LIKE '%%MEDIUM BRUSHED BRASS' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ALGERIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAN') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'FURNITURE' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1994-05-19' AND l_shipdate > date '1994-09-01' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('MAIL', 'FOB') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1997-11-30' AND l_receiptdate < date '1997-11-30' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%cajole%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1994-11-15', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%cornflower%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1998-05-19' AND L_SHIPDATE < date '1998-05-19' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'BRAZIL' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1996-02-26' AND l_shipdate < date '1996-02-26' + interval '1' year AND l_discount between 0.07-1 AND 0.03+1 AND l_quantity < 16


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 26) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-02-06' AND l_shipdate < date '1995-02-06' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'INDONESIA') OR (NA.N_NAME = 'INDONESIA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1995-02-20' AND date '1995-02-20' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'FRANCE' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#33' and p_container in ('JUMBO JAR', 'LG CAN', 'JUMBO PKG', 'WRAP CAN') and l_quantity >= 31 and l_quantity <= 29 + 10 and p_size between 31 and 10 + 15 and l_shipmode in ('SHIP', 'REG AIR') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#44' and p_container in ('WRAP CAN', 'LG CAN', 'SM CASE', 'SM PKG') and l_quantity >= 47 and l_quantity <= 29 + 10 and p_size between 46 and 35 + 15 and l_shipmode in ('FOB', 'AIR') and l_shipinstruct = 'NONE' ) or ( p_partkey = l_partkey and p_brand = 'Brand#11' and p_container in ('WRAP PACK', 'MED CAN', 'JUMBO PACK', 'LG PACK') and l_quantity >= 27 and l_quantity <= 14 + 10 and p_size between 1 and 16 + 15 and l_shipmode in ('RAIL', 'AIR') and l_shipinstruct = 'COLLECT COD' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1996-06-29' AND l_shipdate < date '1996-06-29' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-10-01' AND date '1995-10-01' + interval '1' year AND P_TYPE= 'LARGE POLISHED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('11', '18', '31', '18', '17', '19', '31') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('27', '27', '25', '21', '18', '32', '12') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1997-09-22' and o_orderdate < adddate('1997-09-22', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#15' and p_type like '%ECONOMY POLISHED NICKEL%' and p_size in (33, 12, 17, 22, 13, 31, 47, 7) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%are%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%chocolate%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1995-03-23' AND o_orderdate < date '1995-03-23' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#33' AND P_CONTAINER = 'JUMBO BOX' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1997-04-22' AND O_ORDERDATE < date '1997-04-22' + interval '3' month AND L_RETURNFLAG = 'R' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 2 AND P_TYPE LIKE '%%LARGE POLISHED NICKEL' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'ETHIOPIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'RUSSIA') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'FURNITURE' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1994-08-23' AND l_shipdate > date '1997-06-07' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('MAIL', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-05-10' AND l_receiptdate < date '1996-05-10' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%final%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1997-01-02', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%ghost%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-10-26' AND L_SHIPDATE < date '1996-10-26' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'VIETNAM' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1992-07-07' AND l_shipdate < date '1992-07-07' + interval '1' year AND l_discount between 0.04-1 AND 0.03+1 AND l_quantity < 43


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 29) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1993-01-03' AND l_shipdate < date '1993-01-03' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'JORDAN') OR (NA.N_NAME = 'JORDAN' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1993-02-17' AND date '1993-02-17' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'O' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'INDONESIA' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('JUMBO BOX', 'LG PKG', 'LG CAN', 'JUMBO JAR') and l_quantity >= 36 and l_quantity <= 47 + 10 and p_size between 31 and 11 + 15 and l_shipmode in ('MAIL', 'REG AIR') and l_shipinstruct = 'COLLECT COD' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('SM DRUM', 'WRAP BOX', 'SM DRUM', 'WRAP CASE') and l_quantity >= 47 and l_quantity <= 11 + 10 and p_size between 47 and 5 + 15 and l_shipmode in ('REG AIR', 'RAIL') and l_shipinstruct = 'TAKE BACK RETURN' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('WRAP BAG', 'MED PKG', 'WRAP PACK', 'LG CAN') and l_quantity >= 4 and l_quantity <= 20 + 10 and p_size between 20 and 21 + 15 and l_shipmode in ('FOB', 'SHIP') and l_shipinstruct = 'TAKE BACK RETURN' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1998-04-30' AND l_shipdate < date '1998-04-30' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-09-22' AND date '1995-09-22' + interval '1' year AND P_TYPE= 'SMALL ANODIZED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('31', '16', '31', '31', '20', '11', '32') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('10', '31', '18', '31', '26', '17', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-06-22' and o_orderdate < adddate('1994-06-22', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#33' and p_type like '%SMALL PLATED NICKEL%' and p_size in (37, 48, 49, 15, 38, 11, 47, 8) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%slyly%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%honeydew%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1995-03-23' AND o_orderdate < date '1995-03-23' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#31' AND P_CONTAINER = 'MED CAN' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)


/* TPC_H Query 10 */ SELECT C_CUSTKEY, C_NAME, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS REVENUE, C_ACCTBAL, N_NAME, C_ADDRESS, C_PHONE, C_COMMENT FROM CUSTOMER, ORDERS, LINEITEM, NATION WHERE C_CUSTKEY = O_CUSTKEY AND L_ORDERKEY = O_ORDERKEY AND O_ORDERDATE >= date '1992-12-15' AND O_ORDERDATE < date '1992-12-15' + interval '3' month AND L_RETURNFLAG = 'N' AND C_NATIONKEY = N_NATIONKEY GROUP BY C_CUSTKEY, C_NAME, C_ACCTBAL, C_PHONE, N_NAME, C_ADDRESS, C_COMMENT ORDER BY REVENUE DESC LIMIT 20


/* TPC_H Query 2 */ SELECT S_ACCTBAL, S_NAME, N_NAME, P_PARTKEY, P_MFGR, S_ADDRESS, S_PHONE, S_COMMENT FROM PART, SUPPLIER, PARTSUPP, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND P_SIZE = 35 AND P_TYPE LIKE '%%STANDARD PLATED TIN' AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND PS_SUPPLYCOST = (SELECT MIN(PS_SUPPLYCOST) AS MIN_SUPPLY FROM PARTSUPP, SUPPLIER, NATION, REGION WHERE P_PARTKEY = PS_PARTKEY AND S_SUPPKEY = PS_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE') ORDER BY S_ACCTBAL DESC, N_NAME, S_NAME, P_PARTKEY limit 100


/* TPC_H Query 11 */ SELECT PS_PARTKEY, SUM(PS_SUPPLYCOST*PS_AVAILQTY) AS VALUE FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'INDONESIA' GROUP BY PS_PARTKEY HAVING SUM(PS_SUPPLYCOST*PS_AVAILQTY) > (SELECT SUM(PS_SUPPLYCOST*PS_AVAILQTY) * 0.0001000000 as cost_sum FROM PARTSUPP, SUPPLIER, NATION WHERE PS_SUPPKEY = S_SUPPKEY AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'CHINA') ORDER BY VALUE DESC


/* TPC_H Query 3 */ SELECT l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority FROM customer, orders, lineitem WHERE c_mktsegment = 'HOUSEHOLD' AND c_custkey = o_custkey AND l_orderkey = o_orderkey AND o_orderdate < date '1996-09-21' AND l_shipdate > date '1993-05-16' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY revenue desc, o_orderdate LIMIT 20


/* TPC_H Query 12 */ SELECT l_shipmode, sum(IF(o_orderpriority = '1-urgent' OR o_orderpriority = '2-high', 1, 0)) as high_line_count, sum(IF(o_orderpriority <> '3-medium' AND o_orderpriority <> '4-not specified', 1, 0)) AS low_line_count FROM orders, lineitem WHERE o_orderkey = l_orderkey AND l_shipmode in ('MAIL', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= date '1996-05-10' AND l_receiptdate < date '1996-05-10' + interval '1' year GROUP BY l_shipmode ORDER BY l_shipmode


/* TPC_H Query 13 */ SELECT C_COUNT, COUNT(*) AS CUSTDIST FROM (SELECT C_CUSTKEY, COUNT(O_ORDERKEY) as count_orderkey FROM CUSTOMER LEFT OUTER JOIN ORDERS ON C_CUSTKEY = O_CUSTKEY AND O_COMMENT NOT LIKE '%%haggle%%' GROUP BY C_CUSTKEY) AS C_ORDERS (C_CUSTKEY, C_COUNT) GROUP BY C_COUNT ORDER BY CUSTDIST DESC, C_COUNT DESC


/* TPC_H Query 1 */ SELECT l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order FROM lineitem WHERE l_shipdate <= subdate('1992-12-06', interval '90' day) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus


/* TPC_H Query 20 */ SELECT S_NAME, S_ADDRESS FROM SUPPLIER, NATION WHERE S_SUPPKEY IN (SELECT PS_SUPPKEY FROM PARTSUPP WHERE PS_PARTKEY IN (SELECT P_PARTKEY FROM PART WHERE P_NAME LIKE '%sky%') AND PS_AVAILQTY > (SELECT 0.5*sum(L_QUANTITY) as sum_quantity FROM LINEITEM WHERE L_PARTKEY = PS_PARTKEY AND L_SUPPKEY = PS_SUPPKEY AND L_SHIPDATE >= '1996-04-26' AND L_SHIPDATE < date '1996-04-26' + interval '1' year ) ) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'PERU' ORDER BY S_NAME


/* TPC_H Query 6 */ SELECT sum(l_extendedprice * l_discount) as revenue FROM lineitem WHERE l_shipdate >= date '1997-08-01' AND l_shipdate < date '1997-08-01' + interval '1' year AND l_discount between 0.1-1 AND 0.01+1 AND l_quantity < 24


/* TPC_H Query 18 */ SELECT C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE, SUM(L_QUANTITY) FROM CUSTOMER, ORDERS, LINEITEM WHERE O_ORDERKEY IN (SELECT L_ORDERKEY FROM LINEITEM GROUP BY L_ORDERKEY HAVING SUM(L_QUANTITY) > 6) AND C_CUSTKEY = O_CUSTKEY AND O_ORDERKEY = L_ORDERKEY GROUP BY C_NAME, C_CUSTKEY, O_ORDERKEY, O_ORDERDATE, O_TOTALPRICE ORDER BY O_TOTALPRICE DESC, O_ORDERDATE LIMIT 100


/* TPC_H Query 14 */ SELECT 100.00 * sum(IF(p_type like 'PROMO%', l_extendedprice * (1 - l_discount), 0 )) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue FROM lineitem, part WHERE l_partkey = p_partkey AND l_shipdate >= date '1995-05-03' AND l_shipdate < date '1995-05-03' + interval '1' month


/* TPC_H Query 7 */ SELECT NA_N_NAME, NB_N_NAME, L_YEAR, SUM(VOLUME) AS REVENUE FROM (SELECT NA.N_NAME AS NA_N_NAME, NB.N_NAME AS NB_N_NAME, YEAR(L_SHIPDATE) AS L_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME FROM SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB WHERE S_SUPPKEY = L_SUPPKEY AND O_ORDERKEY = L_ORDERKEY AND C_CUSTKEY = O_CUSTKEY AND S_NATIONKEY = NA.N_NATIONKEY AND C_NATIONKEY = NB.N_NATIONKEY AND ((NA.N_NAME = 'EUROPE' AND NB.N_NAME = 'ETHIOPIA') OR (NA.N_NAME = 'ETHIOPIA' AND NB.N_NAME = 'EUROPE')) AND L_SHIPDATE BETWEEN '1997-10-29' AND date '1997-10-29' + interval '1' year ) AS SHIPPING GROUP BY NA_N_NAME, NB_N_NAME, L_YEAR ORDER BY NA_N_NAME, NB_N_NAME, L_YEAR


/* TPC_H Query 21 */ SELECT S_NAME, COUNT(*) AS NUMWAIT FROM SUPPLIER, LINEITEM LA, ORDERS, NATION WHERE S_SUPPKEY = LA.L_SUPPKEY AND O_ORDERKEY = LA.L_ORDERKEY AND O_ORDERSTATUS = 'F' AND LA.L_RECEIPTDATE> LA.L_COMMITDATE AND EXISTS (SELECT * FROM LINEITEM LB WHERE LB.L_ORDERKEY = LA.L_ORDERKEY AND LB.L_SUPPKEY <> LA.L_SUPPKEY) AND NOT EXISTS (SELECT * FROM LINEITEM LC WHERE LC.L_ORDERKEY = LA.L_ORDERKEY AND LC.L_SUPPKEY <> LA.L_SUPPKEY AND LC.L_RECEIPTDATE > LC.L_COMMITDATE) AND S_NATIONKEY = N_NATIONKEY AND N_NAME = 'IRAQ' GROUP BY S_NAME ORDER BY NUMWAIT DESC, S_NAME LIMIT 100


/* TPC_H Query 19 */ select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('MED BAG', 'WRAP PACK', 'MED BOX', 'MED BOX') and l_quantity >= 47 and l_quantity <= 12 + 10 and p_size between 13 and 47 + 15 and l_shipmode in ('REG AIR', 'TRUCK') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('SM BAG', 'SM PACK', 'LG PACK', 'MED BAG') and l_quantity >= 39 and l_quantity <= 16 + 10 and p_size between 48 and 22 + 15 and l_shipmode in ('MAIL', 'RAIL') and l_shipinstruct = 'NONE' ) or ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('LG BOX', 'SM PACK', 'JUMBO PACK', 'JUMBO JAR') and l_quantity >= 50 and l_quantity <= 34 + 10 and p_size between 37 and 31 + 15 and l_shipmode in ('TRUCK', 'REG AIR') and l_shipinstruct = 'COLLECT COD' )


/* TPC_H Query 15 */ SELECT l_suppkey, sum(l_extendedprice * (1 - l_discount)) as sum_price FROM lineitem WHERE l_shipdate >= date '1996-11-09' AND l_shipdate < date '1996-11-09' + interval '3' MONTH GROUP BY l_suppkey


/* TPC_H Query 8 */ SELECT O_YEAR, SUM(IF(NB_N_NAME = 'BRAZIL', VOLUME, 0))/SUM(VOLUME) AS MKT_SHARE FROM (SELECT YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-03-16' AND date '1993-03-16' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR


/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '30', '21', '10', '12', '22', '21') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from customer where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('20', '15', '20', '16', '32', '30', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode


/* TPC_H Query 4 */ select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-06-22' and o_orderdate < adddate('1994-06-22', interval '3' month) and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority


/* TPC_H Query 16 */ select p_brand, p_type, p_size, count(distinct(ps_suppkey)) as supp_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#32' and p_type like '%ECONOMY BURNISHED BRASS%' and p_size in (9, 24, 47, 28, 1, 16, 35, 5) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%%blithely%%') group by p_brand, p_type, p_size order by supp_cnt desc, p_brand, p_type, p_size


/* TPC_H Query 9 */ SELECT NATION, O_YEAR, SUM(AMOUNT) AS SUM_PROFIT FROM (SELECT N_NAME AS NATION, YEAR(O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT)-PS_SUPPLYCOST*L_QUANTITY AS AMOUNT FROM PART, SUPPLIER, LINEITEM, PARTSUPP, ORDERS, NATION WHERE S_SUPPKEY = L_SUPPKEY AND PS_SUPPKEY= L_SUPPKEY AND PS_PARTKEY = L_PARTKEY AND P_PARTKEY= L_PARTKEY AND O_ORDERKEY = L_ORDERKEY AND S_NATIONKEY = N_NATIONKEY AND P_NAME LIKE '%%midnight%%') AS PROFIT GROUP BY NATION, O_YEAR ORDER BY NATION, O_YEAR DESC


/* TPC_H Query 5 */ SELECT n_name, sum(l_extendedprice * (1 - l_discount)) as revenue FROM customer, orders, lineitem, supplier, nation, region WHERE c_custkey = o_custkey AND l_orderkey = o_orderkey AND l_suppkey = s_suppkey AND c_nationkey = s_nationkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = 'MIDDLE EAST' AND o_orderdate >= date '1993-02-12' AND o_orderdate < date '1993-02-12' + interval '1' year GROUP BY n_name ORDER BY revenue desc


/* TPC_H Query 17 */ SELECT SUM(L_EXTENDEDPRICE)/7.0 AS AVG_YEARLY FROM LINEITEM, PART WHERE P_PARTKEY = L_PARTKEY AND P_BRAND = 'Brand#55' AND P_CONTAINER = 'WRAP PACK' AND L_QUANTITY < (SELECT 0.2*AVG(L_QUANTITY) as avg_quantity FROM LINEITEM WHERE L_PARTKEY = P_PARTKEY)

