/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('12', '23', '17', '22', '23', '34', '11') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('16', '21', '20', '24', '34', '10', '16') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('30', '19', '32', '15', '31', '26', '11') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('31', '16', '14', '17', '18', '34', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('12', '23', '17', '22', '23', '34', '11') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('16', '21', '20', '24', '34', '10', '16') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('31', '22', '25', '14', '34', '10', '31') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('34', '26', '22', '25', '12', '16', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('12', '23', '17', '22', '23', '34', '11') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('16', '21', '20', '24', '34', '10', '16') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('12', '23', '17', '22', '23', '34', '11') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('16', '21', '20', '24', '34', '10', '16') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('12', '23', '17', '22', '23', '34', '11') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('16', '21', '20', '24', '34', '10', '16') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('22', '15', '19', '23', '24', '28', '16') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('26', '27', '23', '25', '19', '32', '14') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('12', '23', '17', '22', '23', '34', '11') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('16', '21', '20', '24', '34', '10', '16') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('12', '23', '17', '22', '23', '34', '11') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('16', '21', '20', '24', '34', '10', '16') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('12', '23', '17', '22', '23', '34', '11') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('16', '21', '20', '24', '34', '10', '16') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('17', '15', '17', '31', '11', '28', '11') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('30', '28', '17', '28', '17', '10', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('12', '23', '17', '22', '23', '34', '11') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('16', '21', '20', '24', '34', '10', '16') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('12', '19', '22', '31', '22', '16', '28') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('26', '19', '18', '32', '25', '17', '16') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('31', '23', '30', '18', '30', '14', '14') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('25', '10', '31', '30', '18', '14', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('12', '23', '17', '22', '23', '34', '11') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('16', '21', '20', '24', '34', '10', '16') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('32', '11', '29', '25', '22', '15', '12') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('29', '26', '29', '22', '12', '28', '14') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('34', '34', '25', '14', '30', '29', '31') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('10', '15', '14', '14', '14', '21', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('14', '19', '20', '26', '21', '33', '15') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('19', '14', '16', '28', '21', '18', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('34', '10', '25', '19', '17', '10', '26') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('12', '15', '19', '29', '27', '16', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('12', '23', '17', '22', '23', '34', '11') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('16', '21', '20', '24', '34', '10', '16') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '22', '22', '12', '23', '27', '22') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('18', '29', '25', '24', '29', '30', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('12', '23', '17', '22', '23', '34', '11') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('16', '21', '20', '24', '34', '10', '16') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('33', '11', '16', '34', '16', '28', '26') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('23', '23', '21', '27', '29', '13', '15') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('26', '25', '26', '21', '16', '23', '23') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('34', '26', '26', '14', '11', '22', '14') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('12', '23', '17', '22', '23', '34', '11') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('16', '21', '20', '24', '34', '10', '16') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('14', '21', '28', '23', '25', '13', '28') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('23', '10', '16', '10', '33', '26', '19') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('12', '23', '17', '22', '23', '34', '11') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('16', '21', '20', '24', '34', '10', '16') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('12', '23', '17', '22', '23', '34', '11') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('16', '21', '20', '24', '34', '10', '16') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('10', '29', '32', '16', '22', '22', '11') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('20', '11', '13', '32', '18', '13', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
