/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1992-03-20' AND date '1992-03-20' + interval '1' year AND P_TYPE= 'ECONOMY BRUSHED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-09-16' AND date '1993-09-16' + interval '1' year AND P_TYPE= 'ECONOMY PLATED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1998-02-26' AND date '1998-02-26' + interval '1' year AND P_TYPE= 'ECONOMY BURNISHED TIN') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-02-14' AND date '1995-02-14' + interval '1' year AND P_TYPE= 'ECONOMY BRUSHED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-12-05' AND date '1993-12-05' + interval '1' year AND P_TYPE= 'ECONOMY BRUSHED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1994-01-21' AND date '1994-01-21' + interval '1' year AND P_TYPE= 'MEDIUM BRUSHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1997-05-25' AND date '1997-05-25' + interval '1' year AND P_TYPE= 'SMALL BRUSHED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-10-30' AND date '1993-10-30' + interval '1' year AND P_TYPE= 'ECONOMY BURNISHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1996-09-27' AND date '1996-09-27' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1994-09-26' AND date '1994-09-26' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-10-28' AND date '1995-10-28' + interval '1' year AND P_TYPE= 'MEDIUM BRUSHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1992-10-10' AND date '1992-10-10' + interval '1' year AND P_TYPE= 'MEDIUM BRUSHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1998-03-05' AND date '1998-03-05' + interval '1' year AND P_TYPE= 'SMALL ANODIZED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1997-04-11' AND date '1997-04-11' + interval '1' year AND P_TYPE= 'PROMO PLATED TIN') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-03-08' AND date '1993-03-08' + interval '1' year AND P_TYPE= 'LARGE POLISHED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1992-08-20' AND date '1992-08-20' + interval '1' year AND P_TYPE= 'MEDIUM BRUSHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1994-02-18' AND date '1994-02-18' + interval '1' year AND P_TYPE= 'LARGE BURNISHED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1998-01-03' AND date '1998-01-03' + interval '1' year AND P_TYPE= 'STANDARD PLATED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1998-06-01' AND date '1998-06-01' + interval '1' year AND P_TYPE= 'LARGE PLATED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-04-19' AND date '1993-04-19' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-10-01' AND date '1995-10-01' + interval '1' year AND P_TYPE= 'LARGE POLISHED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-09-22' AND date '1995-09-22' + interval '1' year AND P_TYPE= 'SMALL ANODIZED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NB_N_NAME = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT date_part('year', O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NB.N_NAME AS NB_N_NAME FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION NA, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA.N_NATIONKEY AND NA.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-03-16' AND date '1993-03-16' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
