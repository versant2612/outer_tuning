/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-03-21' AND date '1995-03-21' + interval '1' year AND P_TYPE= 'MEDIUM ANODIZED TIN') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1997-08-02' AND date '1997-08-02' + interval '1' year AND P_TYPE= 'ECONOMY ANODIZED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1996-05-03' AND date '1996-05-03' + interval '1' year AND P_TYPE= 'LARGE ANODIZED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1994-12-21' AND date '1994-12-21' + interval '1' year AND P_TYPE= 'PROMO PLATED TIN') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1996-09-10' AND date '1996-09-10' + interval '1' year AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-06-30' AND date '1995-06-30' + interval '1' year AND P_TYPE= 'LARGE PLATED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-01-01' AND date '1995-01-01' + interval '1' year AND P_TYPE= 'ECONOMY PLATED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1992-02-19' AND date '1992-02-19' + interval '1' year AND P_TYPE= 'SMALL PLATED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1994-11-27' AND date '1994-11-27' + interval '1' year AND P_TYPE= 'SMALL ANODIZED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1996-05-02' AND date '1996-05-02' + interval '1' year AND P_TYPE= 'ECONOMY POLISHED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1997-03-31' AND date '1997-03-31' + interval '1' year AND P_TYPE= 'ECONOMY ANODIZED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-07-18' AND date '1993-07-18' + interval '1' year AND P_TYPE= 'SMALL PLATED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1994-06-12' AND date '1994-06-12' + interval '1' year AND P_TYPE= 'LARGE ANODIZED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1996-09-22' AND date '1996-09-22' + interval '1' year AND P_TYPE= 'PROMO POLISHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1997-03-05' AND date '1997-03-05' + interval '1' year AND P_TYPE= 'MEDIUM BRUSHED TIN') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1997-06-13' AND date '1997-06-13' + interval '1' year AND P_TYPE= 'LARGE POLISHED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-03-03' AND date '1993-03-03' + interval '1' year AND P_TYPE= 'LARGE POLISHED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-09-17' AND date '1993-09-17' + interval '1' year AND P_TYPE= 'SMALL PLATED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1994-05-08' AND date '1994-05-08' + interval '1' year AND P_TYPE= 'MEDIUM BRUSHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-01-17' AND date '1993-01-17' + interval '1' year AND P_TYPE= 'LARGE PLATED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1992-06-04' AND date '1992-06-04' + interval '1' year AND P_TYPE= 'MEDIUM BRUSHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1994-08-08' AND date '1994-08-08' + interval '1' year AND P_TYPE= 'MEDIUM ANODIZED TIN') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1994-02-28' AND date '1994-02-28' + interval '1' year AND P_TYPE= 'SMALL PLATED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-10-31' AND date '1995-10-31' + interval '1' year AND P_TYPE= 'MEDIUM BRUSHED TIN') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1992-07-03' AND date '1992-07-03' + interval '1' year AND P_TYPE= 'SMALL BRUSHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-04-29' AND date '1995-04-29' + interval '1' year AND P_TYPE= 'LARGE POLISHED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-02-11' AND date '1993-02-11' + interval '1' year AND P_TYPE= 'SMALL BRUSHED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-10-31' AND date '1995-10-31' + interval '1' year AND P_TYPE= 'MEDIUM BRUSHED TIN') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1992-11-01' AND date '1992-11-01' + interval '1' year AND P_TYPE= 'MEDIUM BRUSHED TIN') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN nb_n_name = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT o_year, volume, nb_n_name FROM mv_tap_q8 WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NA_N_NATIONKEY AND NA_N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND S_NATIONKEY = NB_N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-04-06' AND date '1995-04-06' + interval '1' year AND P_TYPE= 'SMALL PLATED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
