/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-03-15' AND dateadd(yy, 1, cast('1996-07-20' AS datetime)) AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1992-06-04' AND dateadd(yy, 1, cast('1998-10-06' AS datetime)) AND P_TYPE= 'ECONOMY PLATED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1996-11-23' AND dateadd(yy, 1, cast('1993-11-23' AS datetime)) AND P_TYPE= 'LARGE ANODIZED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1994-01-01' AND dateadd(yy, 1, cast('1995-02-03' AS datetime)) AND P_TYPE= 'LARGE BURNISHED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-02-18' AND dateadd(yy, 1, cast('1993-05-29' AS datetime)) AND P_TYPE= 'MEDIUM BRUSHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-02-26' AND dateadd(yy, 1, cast('1994-11-24' AS datetime)) AND P_TYPE= 'SMALL ANODIZED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1998-02-09' AND dateadd(yy, 1, cast('1994-01-17' AS datetime)) AND P_TYPE= 'ECONOMY BURNISHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-05-14' AND dateadd(yy, 1, cast('1998-08-29' AS datetime)) AND P_TYPE= 'LARGE POLISHED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1994-11-08' AND dateadd(yy, 1, cast('1997-12-05' AS datetime)) AND P_TYPE= 'LARGE BURNISHED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1996-06-27' AND dateadd(yy, 1, cast('1995-02-22' AS datetime)) AND P_TYPE= 'STANDARD PLATED TIN') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1997-10-31' AND dateadd(yy, 1, cast('1994-02-27' AS datetime)) AND P_TYPE= 'ECONOMY ANODIZED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1997-10-06' AND dateadd(yy, 1, cast('1992-02-01' AS datetime)) AND P_TYPE= 'ECONOMY POLISHED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1996-09-28' AND dateadd(yy, 1, cast('1993-04-02' AS datetime)) AND P_TYPE= 'SMALL BRUSHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-10-17' AND dateadd(yy, 1, cast('1992-06-23' AS datetime)) AND P_TYPE= 'LARGE PLATED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'EUROPE' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1996-06-23' AND dateadd(yy, 1, cast('1995-10-02' AS datetime)) AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1997-01-10' AND dateadd(yy, 1, cast('1995-08-31' AS datetime)) AND P_TYPE= 'SMALL BRUSHED BRASS') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-11-16' AND dateadd(yy, 1, cast('1995-06-14' AS datetime)) AND P_TYPE= 'ECONOMY BRUSHED COPPER') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-03-15' AND dateadd(yy, 1, cast('1996-07-20' AS datetime)) AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1994-04-13' AND dateadd(yy, 1, cast('1995-10-09' AS datetime)) AND P_TYPE= 'SMALL POLISHED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-03-15' AND dateadd(yy, 1, cast('1996-07-20' AS datetime)) AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'ASIA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-03-30' AND dateadd(yy, 1, cast('1995-10-24' AS datetime)) AND P_TYPE= 'MEDIUM POLISHED NICKEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-03-15' AND dateadd(yy, 1, cast('1996-07-20' AS datetime)) AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1996-07-15' AND dateadd(yy, 1, cast('1996-06-19' AS datetime)) AND P_TYPE= 'MEDIUM BRUSHED TIN') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1996-09-19' AND dateadd(yy, 1, cast('1994-09-26' AS datetime)) AND P_TYPE= 'PROMO PLATED TIN') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-03-15' AND dateadd(yy, 1, cast('1996-07-20' AS datetime)) AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AMERICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1996-11-16' AND dateadd(yy, 1, cast('1997-10-12' AS datetime)) AND P_TYPE= 'MEDIUM ANODIZED TIN') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-03-15' AND dateadd(yy, 1, cast('1996-07-20' AS datetime)) AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-03-15' AND dateadd(yy, 1, cast('1996-07-20' AS datetime)) AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'AFRICA' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1993-03-15' AND dateadd(yy, 1, cast('1996-07-20' AS datetime)) AND P_TYPE= 'MEDIUM BURNISHED STEEL') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
/* TPC_H Query 8 */ SELECT O_YEAR, SUM(CASE WHEN NATION = 'BRAZIL' THEN VOLUME ELSE 0 END)/SUM(VOLUME) AS MKT_SHARE FROM (SELECT datepart(yy, O_ORDERDATE) AS O_YEAR, L_EXTENDEDPRICE*(1-L_DISCOUNT) AS VOLUME, NATION.N_NAME AS NATION FROM PART, SUPPLIER, LINEITEM, ORDERS, CUSTOMER, NATION, NATION NB, REGION WHERE P_PARTKEY = L_PARTKEY AND S_SUPPKEY = L_SUPPKEY AND L_ORDERKEY = O_ORDERKEY AND O_CUSTKEY = C_CUSTKEY AND C_NATIONKEY = NATION.N_NATIONKEY AND NATION.N_REGIONKEY = R_REGIONKEY AND R_NAME = 'MIDDLE EAST' AND S_NATIONKEY = NB.N_NATIONKEY AND O_ORDERDATE BETWEEN '1995-09-07' AND dateadd(yy, 1, cast('1994-04-16' AS datetime)) AND P_TYPE= 'ECONOMY BURNISHED TIN') AS ALL_NATIONS GROUP BY O_YEAR ORDER BY O_YEAR;;
