/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('18', '11', '13', '14', '33', '14', '23') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('10', '21', '15', '33', '27', '12', '33') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('33', '34', '19', '26', '24', '19', '17') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('11', '22', '30', '23', '14', '28', '20') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('15', '14', '25', '18', '20', '24', '33') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('16', '31', '10', '11', '24', '21', '11') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('23', '17', '20', '32', '12', '26', '14') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('29', '21', '21', '13', '23', '25', '13') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('19', '31', '23', '22', '10', '20', '27') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('22', '20', '30', '19', '20', '18', '26') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('18', '11', '13', '14', '33', '14', '23') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('10', '21', '15', '33', '27', '12', '33') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('17', '29', '22', '23', '32', '12', '10') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('10', '24', '21', '27', '11', '28', '30') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('18', '22', '31', '33', '19', '25', '31') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('12', '28', '23', '30', '14', '10', '14') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('18', '11', '13', '14', '33', '14', '23') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('10', '21', '15', '33', '27', '12', '33') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('14', '26', '12', '33', '17', '22', '16') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('31', '18', '28', '26', '16', '11', '29') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('29', '25', '12', '29', '25', '18', '27') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('23', '15', '21', '16', '32', '19', '23') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('24', '11', '11', '22', '11', '29', '15') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('27', '17', '25', '19', '32', '29', '14') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('18', '11', '13', '14', '33', '14', '23') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('10', '21', '15', '33', '27', '12', '33') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('11', '12', '14', '27', '12', '15', '27') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('19', '21', '18', '13', '23', '33', '12') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('18', '11', '13', '14', '33', '14', '23') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('10', '21', '15', '33', '27', '12', '33') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('18', '11', '13', '14', '33', '14', '23') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('10', '21', '15', '33', '27', '12', '33') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('20', '34', '28', '15', '32', '11', '12') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('21', '28', '16', '10', '27', '27', '34') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('18', '11', '13', '14', '33', '14', '23') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('10', '21', '15', '33', '27', '12', '33') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('27', '23', '33', '10', '26', '12', '23') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('21', '11', '17', '25', '15', '27', '20') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('14', '28', '18', '33', '29', '28', '22') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('12', '18', '32', '21', '23', '31', '24') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('33', '22', '12', '11', '19', '25', '24') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('32', '27', '25', '21', '14', '25', '24') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('12', '33', '20', '13', '34', '12', '29') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('25', '31', '15', '20', '32', '29', '20') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('15', '27', '11', '13', '30', '33', '23') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('12', '24', '20', '14', '24', '12', '19') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('18', '21', '24', '31', '10', '16', '21') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('32', '16', '18', '32', '17', '20', '29') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('29', '12', '19', '30', '32', '12', '19') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('34', '13', '20', '18', '31', '34', '17') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('23', '31', '13', '21', '10', '26', '19') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('14', '20', '13', '10', '31', '28', '33') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('18', '11', '13', '14', '33', '14', '23') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('10', '21', '15', '33', '27', '12', '33') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('26', '19', '13', '34', '33', '27', '32') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('27', '34', '15', '27', '31', '16', '23') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('20', '13', '16', '19', '18', '11', '10') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('25', '15', '21', '31', '13', '21', '12') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 2) cntrycode, c_acctbal from h_customer where substr(c_phone , 0, 2) in ('21', '24', '24', '34', '34', '11', '13') and c_acctbal > ( select avg(c_acctbal) avg_acctbal from h_customer where c_acctbal > 0.00 and substr(c_phone , 0, 2) in ('30', '25', '11', '23', '22', '25', '25') ) and not exists ( select * from h_order where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;
