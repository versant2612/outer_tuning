/* TPC_H Query 8 */ select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-04-01' and date '1995-04-01' + interval '1' month and p_type = 'ECONOMY PLATED STEEL' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'JORDAN' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-06-14' and date '1995-06-14' + interval '1' month and p_type = 'MEDIUM BRUSHED TIN' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1996-05-14' and date '1996-05-14' + interval '1' month and p_type = 'LARGE POLISHED COPPER' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-04-01' and date '1995-04-01' + interval '1' month and p_type = 'ECONOMY PLATED STEEL' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1996-06-30' and date '1996-06-30' + interval '1' month and p_type = 'ECONOMY BURNISHED TIN' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'MOROCCO' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1993-01-26' and date '1993-01-26' + interval '1' month and p_type = 'ECONOMY BURNISHED BRASS' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1998-03-07' and date '1998-03-07' + interval '1' month and p_type = 'SMALL BRUSHED TIN' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-04-01' and date '1995-04-01' + interval '1' month and p_type = 'ECONOMY PLATED STEEL' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'JORDAN' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1997-04-02' and date '1997-04-02' + interval '1' month and p_type = 'MEDIUM POLISHED NICKEL' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-12-19' and date '1995-12-19' + interval '1' month and p_type = 'MEDIUM BURNISHED COPPER' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-12-05' and date '1995-12-05' + interval '1' month and p_type = 'SMALL POLISHED NICKEL' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-04-01' and date '1995-04-01' + interval '1' month and p_type = 'ECONOMY PLATED STEEL' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-04-01' and date '1995-04-01' + interval '1' month and p_type = 'ECONOMY PLATED STEEL' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1994-05-17' and date '1994-05-17' + interval '1' month and p_type = 'STANDARD PLATED BRASS' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1992-09-08' and date '1992-09-08' + interval '1' month and p_type = 'SMALL ANODIZED COPPER' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-04-01' and date '1995-04-01' + interval '1' month and p_type = 'ECONOMY PLATED STEEL' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1993-11-06' and date '1993-11-06' + interval '1' month and p_type = 'ECONOMY BRUSHED COPPER' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'MOROCCO' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1997-03-22' and date '1997-03-22' + interval '1' month and p_type = 'STANDARD PLATED BRASS' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1993-04-22' and date '1993-04-22' + interval '1' month and p_type = 'MEDIUM BURNISHED STEEL' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1992-02-05' and date '1992-02-05' + interval '1' month and p_type = 'LARGE POLISHED NICKEL' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1994-06-02' and date '1994-06-02' + interval '1' month and p_type = 'MEDIUM BRUSHED BRASS' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1993-07-04' and date '1993-07-04' + interval '1' month and p_type = 'MEDIUM BRUSHED TIN' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-04-01' and date '1995-04-01' + interval '1' month and p_type = 'ECONOMY PLATED STEEL' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-07-07' and date '1995-07-07' + interval '1' month and p_type = 'LARGE PLATED NICKEL' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'MOROCCO' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-08-27' and date '1995-08-27' + interval '1' month and p_type = 'ECONOMY BURNISHED TIN' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1996-10-01' and date '1996-10-01' + interval '1' month and p_type = 'ECONOMY POLISHED NICKEL' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1997-02-27' and date '1997-02-27' + interval '1' month and p_type = 'SMALL BRUSHED NICKEL' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-04-01' and date '1995-04-01' + interval '1' month and p_type = 'ECONOMY PLATED STEEL' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1994-09-22' and date '1994-09-22' + interval '1' month and p_type = 'LARGE ANODIZED COPPER' ) all_nations group by o_year order by o_year;
/* TPC_H Query 8 */ select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) mkt_share from ( select cast(SUBSTR(cast(o_orderdate AS VARCHAR2(30)),7, 2) AS INT) o_year, l_extendedprice * (1 - l_discount) volume, n2.n_name nation from h_part, h_supplier, h_lineitem, h_order, h_customer, h_nation n1, h_nation n2, h_region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = ':2' and s_nationkey = n2.n_nationkey and o_orderdate between date '1993-03-27' and date '1993-03-27' + interval '1' month and p_type = 'STANDARD PLATED BRASS' ) all_nations group by o_year order by o_year;
