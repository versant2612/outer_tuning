/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('14', '21', '10', '30', '20', '27', '10') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('28', '21', '22', '20', '27', '16', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('20', '20', '23', '18', '29', '26', '29') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('32', '33', '21', '14', '27', '12', '18') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('15', '28', '26', '10', '17', '29', '31') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('30', '34', '17', '11', '34', '16', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('26', '30', '16', '21', '22', '10', '19') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('32', '32', '12', '19', '17', '33', '33') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '16', '13', '28', '24', '13', '22') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('22', '11', '19', '22', '14', '30', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '27', '24', '25', '21', '14', '34') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('19', '32', '32', '28', '31', '19', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('25', '18', '19', '32', '13', '19', '21') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('14', '25', '18', '23', '28', '22', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('10', '33', '25', '11', '10', '20', '20') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('28', '14', '26', '11', '12', '16', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('18', '31', '22', '31', '29', '13', '31') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('22', '10', '21', '23', '26', '14', '17') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('25', '23', '29', '33', '11', '26', '34') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('34', '25', '25', '32', '24', '24', '18') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('12', '13', '32', '27', '31', '33', '33') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('16', '19', '32', '11', '27', '23', '16') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('16', '28', '29', '32', '30', '12', '32') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('26', '19', '20', '14', '26', '22', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '28', '22', '29', '22', '32', '22') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('23', '17', '22', '27', '32', '29', '14') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('14', '10', '15', '15', '21', '11', '27') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('25', '33', '24', '10', '13', '24', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('21', '10', '34', '19', '20', '26', '16') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('21', '20', '30', '34', '25', '17', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('30', '14', '30', '25', '13', '11', '25') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('18', '17', '27', '28', '24', '18', '16') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('25', '23', '29', '33', '11', '26', '34') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('34', '25', '25', '32', '24', '24', '18') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('29', '18', '27', '23', '10', '16', '32') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('30', '19', '17', '21', '22', '32', '14') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('19', '30', '31', '14', '28', '25', '20') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('27', '26', '31', '34', '15', '28', '33') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('31', '32', '27', '19', '33', '20', '19') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('22', '25', '16', '33', '25', '13', '11') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('25', '23', '29', '33', '11', '26', '34') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('34', '25', '25', '32', '24', '24', '18') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('10', '22', '27', '17', '10', '29', '17') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('12', '32', '34', '29', '27', '27', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('30', '28', '14', '34', '31', '16', '15') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('15', '34', '23', '32', '27', '33', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('25', '23', '29', '33', '11', '26', '34') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('34', '25', '25', '32', '24', '24', '18') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('19', '19', '13', '27', '19', '32', '11') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('34', '14', '14', '11', '25', '30', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('33', '22', '16', '23', '33', '33', '17') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('14', '29', '26', '29', '16', '15', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('20', '32', '14', '12', '16', '33', '12') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('13', '13', '18', '28', '25', '12', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('16', '12', '31', '27', '24', '12', '23') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('29', '17', '23', '23', '29', '18', '22') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('28', '13', '25', '27', '17', '11', '21') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('12', '16', '17', '19', '15', '30', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
/* TPC_H Query 22 */ select cntrycode, count(*) numcust, sum(c_acctbal) totacctbal from ( select substr(c_phone , 0, 3) cntrycode, c_acctbal from customer where substr(c_phone , 0, 3) in ('16', '34', '31', '21', '11', '29', '30') and c_acctbal > ( select avg(avg_acctbal) avg_acctbal FROM mv_tap_q22 where c_acctbal > 0.00 and substr(c_phone , 0, 3) in ('24', '20', '20', '15', '27', '20', '12') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) custsale group by cntrycode order by cntrycode;;
